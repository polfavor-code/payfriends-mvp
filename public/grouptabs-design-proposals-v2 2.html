<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PayFriends Design Lab v2: GroupTabs View</title>
  
  <!-- Shared Styles -->
  <link rel="stylesheet" href="/css/shared-controls.css">
  <link rel="stylesheet" href="/css/app.css">
  <link rel="stylesheet" href="/css/chat-theme.css">
  <link rel="stylesheet" href="/css/grouptabs.css">
  
  <style>
    :root {
      --proposal-bg: #0e1116;
      --proposal-card-bg: #161b24;
      --proposal-border: rgba(255, 255, 255, 0.1);
    }
    
    body {
      background: var(--proposal-bg);
      color: #fff;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    
    /* --- Top Navigation --- */
    .lab-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(14, 17, 22, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--proposal-border);
      z-index: 1000;
      padding: 12px 24px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .lab-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .lab-title {
      font-weight: 700;
      font-size: 18px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .lab-controls {
      display: flex;
      gap: 16px;
      align-items: center;
    }
    
    .lab-select {
      background: var(--proposal-card-bg);
      border: 1px solid var(--proposal-border);
      color: #fff;
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 14px;
    }
    
    .version-switcher {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      padding-bottom: 4px;
    }
    
    .version-btn {
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--proposal-border);
      border-radius: 20px;
      color: var(--muted);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
    }
    
    .version-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
    }
    
    .version-btn.active {
      background: var(--accent);
      color: #0e1116;
      border-color: var(--accent);
    }
    
    /* --- Main Content Area --- */
    .lab-content {
      margin-top: 120px;
      padding: 24px;
      display: flex;
      justify-content: center;
    }
    
    .proposal-container {
      width: 100%;
      max-width: 480px; /* Mobile-first constraint */
      min-height: 800px;
      display: none; /* Hidden by default */
    }
    
    .proposal-container.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* --- Common Utility Classes for Mockups --- */
    .mock-screen {
      background: #000;
      border-radius: 32px;
      overflow: hidden;
      border: 8px solid #333;
      position: relative;
      min-height: 800px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.5);
    }
    
    .status-bar {
      height: 44px;
      padding: 0 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      font-weight: 600;
      color: #fff;
    }
    
    /* --- SVG Stamps Definitions --- */
    .stamp-svg {
      display: none; /* Included for reference */
    }
    
  </style>
</head>
<body>

  <!-- Navigation -->
  <nav class="lab-nav">
    <div class="lab-header">
      <div class="lab-title">üé® Design Lab v2</div>
      <div class="lab-controls">
        <select class="lab-select" id="mode-select" onchange="updateView()">
          <option value="equal">Mode: Equal Split</option>
          <option value="price_groups">Mode: Price Groups</option>
          <option value="magic_intro">Mode: Magic Link Intro</option>
        </select>
        <select class="lab-select" id="role-select" onchange="updateView()">
          <option value="organizer">Role: Organizer</option>
          <option value="guest">Role: Guest (Participant)</option>
        </select>
      </div>
    </div>
    <div class="version-switcher">
      <button class="version-btn active" onclick="switchVersion(1)">1. Minimalist</button>
      <button class="version-btn" onclick="switchVersion(2)">2. Funky Stamp (Fav)</button>
      <button class="version-btn" onclick="switchVersion(3)">3. Chat Thread</button>
      <button class="version-btn" onclick="switchVersion(4)">4. Receipt</button>
      <button class="version-btn" onclick="switchVersion(5)">5. Neon Dark</button>
      <button class="version-btn" onclick="switchVersion(6)">6. Story Mode</button>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="lab-content">
    
    <!-- Version 1: Minimalist -->
    <div id="v1" class="proposal-container active">
      <style>
        #v1 .mock-screen {
          background: #000;
          color: #fff;
          font-family: -apple-system, sans-serif;
          padding: 24px;
          overflow-y: auto;
        }
        
        #v1 .v1-header {
          margin-top: 60px;
          margin-bottom: 32px;
        }
        
        #v1 .v1-eyebrow {
          font-size: 12px;
          text-transform: uppercase;
          letter-spacing: 2px;
          color: #666;
          margin-bottom: 8px;
        }
        
        #v1 .v1-h1 {
          font-size: 32px;
          font-weight: 300;
          margin: 0;
          line-height: 1.2;
        }
        
        #v1 .v1-card {
          background: #111;
          border: 1px solid #333;
          border-radius: 8px;
          padding: 24px;
          margin-bottom: 24px;
        }
        
        #v1 .v1-stat-row {
          display: flex;
          justify-content: space-between;
          margin-bottom: 16px;
          padding-bottom: 16px;
          border-bottom: 1px solid #222;
        }
        
        #v1 .v1-stat-row:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
        }
        
        #v1 .v1-label {
          color: #666;
          font-size: 14px;
        }
        
        #v1 .v1-value {
          font-weight: 500;
        }
        
        #v1 .v1-list-item {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 16px 0;
          border-bottom: 1px solid #222;
        }
        
        #v1 .v1-avatar-group {
          display: flex;
          align-items: center;
          gap: 12px;
        }
        
        #v1 .v1-avatar {
          width: 32px;
          height: 32px;
          background: #222;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 12px;
          color: #666;
        }
        
        #v1 .v1-status-dot {
          width: 8px;
          height: 8px;
          border-radius: 50%;
          background: #333;
        }
        
        #v1 .v1-status-dot.paid { background: #fff; }
        
        #v1 .v1-btn {
          width: 100%;
          padding: 16px;
          background: #fff;
          color: #000;
          border: none;
          border-radius: 4px;
          font-weight: 600;
          margin-top: 24px;
          cursor: pointer;
        }
        
        #v1 .v1-magic-input {
          background: transparent;
          border: none;
          border-bottom: 1px solid #333;
          color: #fff;
          font-size: 24px;
          width: 100%;
          padding: 8px 0;
          margin-bottom: 32px;
        }
        
        #v1 .v1-magic-input:focus {
          outline: none;
          border-color: #fff;
        }
      </style>
      
      <div class="mock-screen">
        
        <!-- Status Bar -->
        <div class="status-bar">
          <span>9:41</span>
          <span>PayFriends</span>
          <span>100%</span>
        </div>

        <!-- MAGIC LINK INTRO -->
        <div class="v1-magic-intro" data-scenario="magic_intro">
          <div class="v1-header">
            <div class="v1-eyebrow">Welcome Guest</div>
            <h1 class="v1-h1">Identify<br>Yourself</h1>
          </div>
          
          <div style="margin-bottom: 40px;">
            <label class="v1-label" style="display:block; margin-bottom:12px;">Your Name</label>
            <input type="text" class="v1-magic-input" placeholder="Type here...">
          </div>
          
          <!-- Price Groups Selection -->
          <div data-mode-show="price_groups" style="margin-bottom:40px;">
            <label class="v1-label" style="display:block; margin-bottom:16px;">Select Group</label>
            <div style="display:flex; flex-direction:column; gap:8px;">
              <div style="border:1px solid #fff; padding:16px; display:flex; justify-content:space-between;">
                <span>Alcohol Drinker</span>
                <span>‚Ç¨25.00</span>
              </div>
              <div style="border:1px solid #333; color:#666; padding:16px; display:flex; justify-content:space-between;">
                <span>Non-Alcohol</span>
                <span>‚Ç¨15.00</span>
              </div>
            </div>
          </div>
          
          <button class="v1-btn">Continue</button>
        </div>

        <!-- MAIN VIEW -->
        <div class="v1-main-view" data-scenario="main">
          <div class="v1-header">
            <div class="v1-eyebrow">GroupTab</div>
            <h1 class="v1-h1">Dinner at Mario's</h1>
          </div>
          
          <div class="v1-card">
            <div class="v1-stat-row">
              <span class="v1-label">Total Bill</span>
              <span class="v1-value">‚Ç¨142.50</span>
            </div>
            <div class="v1-stat-row">
              <span class="v1-label">Collected</span>
              <span class="v1-value">‚Ç¨92.50</span>
            </div>
            <div class="v1-stat-row">
              <span class="v1-label">Status</span>
              <span class="v1-value">Open</span>
            </div>
          </div>
          
          <!-- Price Group Summary -->
          <div class="v1-card" data-mode-show="price_groups">
            <div class="v1-stat-row">
              <span class="v1-label">Alcohol (2)</span>
              <span class="v1-value">‚Ç¨25.00/ea</span>
            </div>
            <div class="v1-stat-row">
              <span class="v1-label">No Alc (1)</span>
              <span class="v1-value">‚Ç¨15.00/ea</span>
            </div>
          </div>
          
          <div style="margin-top: 32px;">
            <div class="v1-eyebrow">Participants</div>
            
            <div class="v1-list-item">
              <div class="v1-avatar-group">
                <div class="v1-avatar">ME</div>
                <div>
                  <div class="v1-value">You</div>
                  <div class="v1-label" data-mode-show="equal">‚Ç¨35.60</div>
                  <div class="v1-label" data-mode-show="price_groups">Alcohol</div>
                </div>
              </div>
              <div class="v1-status-dot paid"></div>
            </div>
            
            <div class="v1-list-item">
              <div class="v1-avatar-group">
                <div class="v1-avatar">JD</div>
                <div>
                  <div class="v1-value">John Doe</div>
                  <div class="v1-label" data-mode-show="equal">‚Ç¨35.60</div>
                  <div class="v1-label" data-mode-show="price_groups">No Alc</div>
                </div>
              </div>
              <div class="v1-status-dot"></div>
            </div>
          </div>
          
          <button class="v1-btn">Report Payment</button>
        </div>
        
      </div>
      
      <script>
        // V1 Logic
        (function() {
          const container = document.querySelector('#v1 .mock-screen');
          const observer = new MutationObserver(() => {
            const mode = container.getAttribute('data-mode');
            const isMagic = mode === 'magic_intro';
            
            document.querySelector('#v1 .v1-magic-intro').style.display = isMagic ? 'block' : 'none';
            document.querySelector('#v1 .v1-main-view').style.display = isMagic ? 'none' : 'block';
            
            container.querySelectorAll('[data-mode-show]').forEach(el => {
              el.style.display = el.getAttribute('data-mode-show') === mode ? 'block' : 'none';
            });
          });
          observer.observe(container, { attributes: true });
        })();
      </script>
    </div>

    <!-- Version 2: Funky Stamp -->
    <div id="v2" class="proposal-container">
      <style>
        /* --- V2 Styles --- */
        #v2 .mock-screen {
          background: #1a1d24;
          font-family: 'Segoe UI', sans-serif;
          overflow-y: auto;
        }
        
        #v2 .v2-header {
          padding: 24px;
          padding-top: 60px;
          position: relative;
        }
        
        #v2 .v2-title-card {
          background: #2a303c;
          border: 2px solid rgba(255,255,255,0.1);
          border-radius: 24px;
          padding: 20px;
          transform: rotate(-1deg);
          box-shadow: 0 10px 30px rgba(0,0,0,0.3);
          margin-bottom: 24px;
          position: relative;
        }
        
        #v2 .v2-title-card::before {
          content: '';
          position: absolute;
          top: -6px;
          left: 50%;
          transform: translateX(-50%);
          width: 40px;
          height: 12px;
          background: rgba(255,255,255,0.1);
          border-radius: 6px; /* Tape look */
        }
        
        #v2 .v2-h1 {
          font-size: 24px;
          font-weight: 800;
          margin: 0 0 8px 0;
          color: #fff;
        }
        
        #v2 .v2-price-tag {
          display: inline-block;
          background: #3ddc97;
          color: #000;
          font-weight: 800;
          padding: 4px 12px;
          border-radius: 4px;
          transform: rotate(2deg);
          font-size: 18px;
          box-shadow: 2px 2px 0 #000;
        }
        
        #v2 .v2-list {
          padding: 0 16px;
        }
        
        #v2 .v2-item {
          background: #22262e;
          border-radius: 16px;
          padding: 16px;
          margin-bottom: 12px;
          display: flex;
          align-items: center;
          gap: 16px;
          border: 1px solid rgba(255,255,255,0.05);
          position: relative;
          transition: transform 0.2s;
        }
        
        #v2 .v2-item:active {
          transform: scale(0.98);
        }
        
        #v2 .v2-avatar {
          width: 48px;
          height: 48px;
          background: #333;
          border-radius: 50%;
          border: 3px solid #fff; /* Sticker border */
          box-shadow: 0 4px 8px rgba(0,0,0,0.2);
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 20px;
        }
        
        #v2 .v2-name {
          font-weight: 700;
          font-size: 16px;
          margin-bottom: 4px;
        }
        
        #v2 .v2-status {
          font-size: 13px;
          color: #888;
        }
        
        #v2 .v2-stamp {
          position: absolute;
          right: 16px;
          top: 50%;
          transform: translateY(-50%) rotate(-10deg);
          opacity: 0.8;
        }
        
        #v2 .stamp-box {
          border: 3px solid;
          padding: 4px 8px;
          font-weight: 900;
          font-size: 12px;
          text-transform: uppercase;
          border-radius: 4px;
          letter-spacing: 1px;
        }
        
        #v2 .stamp-paid { color: #3ddc97; border-color: #3ddc97; }
        #v2 .stamp-pending { color: #fbbf24; border-color: #fbbf24; border-style: dashed; }
        
        #v2 .v2-fab {
          position: absolute;
          bottom: 32px;
          right: 24px;
          background: #6366f1;
          color: #fff;
          width: 64px;
          height: 64px;
          border-radius: 24px; /* Squircle */
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 32px;
          box-shadow: 4px 4px 0 #000;
          transform: rotate(3deg);
          border: 2px solid #fff;
          z-index: 10;
        }
        
        /* Magic Link View Styles */
        #v2 .v2-magic-card {
          margin: 24px;
          margin-top: 100px;
          background: #2a303c;
          border-radius: 32px;
          padding: 32px;
          text-align: center;
          border: 2px solid #3ddc97;
          box-shadow: 0 0 0 4px rgba(61, 220, 151, 0.2);
        }
        
        #v2 .v2-input {
          width: 100%;
          background: #1a1d24;
          border: 2px solid #444;
          padding: 16px;
          border-radius: 12px;
          color: #fff;
          font-size: 18px;
          font-weight: 600;
          margin: 24px 0;
          text-align: center;
        }
        
        #v2 .v2-input:focus {
          border-color: #3ddc97;
          outline: none;
        }
        
        /* Price Group Chips V2 */
        #v2 .v2-chips {
          display: flex;
          gap: 12px;
          overflow-x: auto;
          padding: 4px;
          margin-bottom: 24px;
        }
        
        #v2 .v2-chip {
          background: #222;
          border: 2px solid #444;
          border-radius: 16px;
          padding: 12px 20px;
          min-width: 100px;
          text-align: center;
          cursor: pointer;
        }
        
        #v2 .v2-chip.selected {
          background: rgba(61, 220, 151, 0.1);
          border-color: #3ddc97;
          box-shadow: 0 4px 0 #3ddc97;
          transform: translateY(-4px);
        }
        
        /* Toggle Visibility */
        #v2 [data-show="false"] { display: none !important; }
        
      </style>
      
      <div class="mock-screen">
        
        <!-- HEADER (Always Visible) -->
        <div class="status-bar">
          <span>9:41</span>
          <span>PayFriends</span>
          <span>üîã</span>
        </div>

        <!-- SCENARIO 1: MAGIC LINK INTRO -->
        <div class="v2-magic-intro" data-scenario="magic_intro">
          <div class="v2-magic-card">
            <div style="font-size: 64px; margin-bottom: 16px;">üëã</div>
            <h1 class="v2-h1">Who dis?</h1>
            <p style="color:#aaa; margin-bottom: 24px;">Let the group know it's you.</p>
            
            <input type="text" class="v2-input" placeholder="Your Name">
            
            <!-- Price Groups Selection (Conditional) -->
            <div class="v2-pg-select" data-mode-show="price_groups">
              <p style="font-weight:600; margin-bottom:12px;">Pick your squad:</p>
              <div class="v2-chips">
                <div class="v2-chip selected">
                  <div style="font-size:24px">üç∑</div>
                  <div style="font-weight:700; margin-top:4px">Alcohol</div>
                  <div style="font-size:12px; color:#888">‚Ç¨25.00</div>
                </div>
                <div class="v2-chip">
                  <div style="font-size:24px">üíß</div>
                  <div style="font-weight:700; margin-top:4px">No Alc</div>
                  <div style="font-size:12px; color:#888">‚Ç¨15.00</div>
                </div>
              </div>
            </div>
            
            <button class="v2-fab" style="position:static; width:100%; margin-top:12px; transform:none; box-shadow:none; border-radius:16px; font-size:18px; font-weight:800;">
              JOIN PARTY
            </button>
          </div>
        </div>

        <!-- SCENARIO 2: MAIN VIEW -->
        <div class="v2-main-view" data-scenario="main">
          <div class="v2-header">
            <div class="v2-title-card">
              <div style="display:flex; justify-content:space-between; align-items:start">
                <div>
                  <h1 class="v2-h1">Dinner at Mario's üçù</h1>
                  <div style="display:flex; gap:8px; margin-top:8px;">
                    <span class="v2-price-tag">‚Ç¨142.50</span>
                    <span style="background:#333; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:700; display:flex; align-items:center;">4 PPL</span>
                  </div>
                </div>
                <div class="v2-avatar" style="width:40px;height:40px; border-width:2px;">Receipt</div>
              </div>
              
              <!-- Progress Bar -->
              <div style="margin-top:20px; background:#111; height:12px; border-radius:6px; overflow:hidden; border:1px solid #444;">
                <div style="width:65%; background:#3ddc97; height:100%;"></div>
              </div>
              <div style="display:flex; justify-content:space-between; font-size:11px; font-weight:700; margin-top:6px; color:#aaa;">
                <span>COLLECTED ‚Ç¨92.50</span>
                <span style="color:#fbbf24">MISSING ‚Ç¨50.00</span>
              </div>
            </div>
            
            <!-- Groups Summary (Price Groups Mode Only) -->
            <div class="v2-pg-summary" data-mode-show="price_groups" style="margin-bottom:24px;">
              <h3 style="font-size:14px; text-transform:uppercase; letter-spacing:1px; color:#666; margin-bottom:12px;">The Split</h3>
              <div style="display:flex; gap:10px; overflow-x:auto;">
                <div style="background:#222; padding:8px 12px; border-radius:12px; border:1px solid #333; min-width:100px;">
                  <div style="font-size:12px; color:#888">üç∑ Alcohol</div>
                  <div style="font-weight:700; color:#fff">‚Ç¨25.00</div>
                  <div style="font-size:10px; color:#555">2 people</div>
                </div>
                <div style="background:#222; padding:8px 12px; border-radius:12px; border:1px solid #333; min-width:100px;">
                  <div style="font-size:12px; color:#888">üíß No Alc</div>
                  <div style="font-weight:700; color:#fff">‚Ç¨15.00</div>
                  <div style="font-size:10px; color:#555">1 person</div>
                </div>
              </div>
            </div>

            <h3 style="font-size:14px; text-transform:uppercase; letter-spacing:1px; color:#666; margin-bottom:16px;">Squad List</h3>
            
            <div class="v2-list">
              <!-- Self -->
              <div class="v2-item">
                <div class="v2-avatar">
                  <img src="https://i.pravatar.cc/150?u=1" style="width:100%;height:100%;object-fit:cover;">
                </div>
                <div style="flex:1">
                  <div class="v2-name">You (Paul)</div>
                  <div class="v2-status">
                    <span data-mode-show="equal">Share: ‚Ç¨35.60</span>
                    <span data-mode-show="price_groups">üç∑ Group (‚Ç¨25.00)</span>
                  </div>
                </div>
                <div class="v2-stamp">
                  <div class="stamp-box stamp-paid">PAID</div>
                </div>
              </div>

              <!-- Friend 1 -->
              <div class="v2-item">
                <div class="v2-avatar" style="background:#6366f1; color:#fff;">JD</div>
                <div style="flex:1">
                  <div class="v2-name">John Doe</div>
                  <div class="v2-status">
                    <span data-mode-show="equal">Share: ‚Ç¨35.60</span>
                    <span data-mode-show="price_groups">üíß Group (‚Ç¨15.00)</span>
                  </div>
                </div>
                <div class="v2-stamp">
                  <div class="stamp-box stamp-pending">PENDING</div>
                </div>
              </div>
              
              <!-- Unassigned Guest (Price Groups) -->
              <div class="v2-item" data-mode-show="price_groups">
                <div class="v2-avatar" style="background:#333; border-style:dashed; color:#555;">?</div>
                <div style="flex:1">
                  <div class="v2-name" style="color:#777">Waiting...</div>
                  <div class="v2-status" style="color:#d97706">‚ùì Unassigned</div>
                </div>
                <button style="background:rgba(255,255,255,0.1); border:none; color:#fff; padding:6px 12px; border-radius:8px; font-size:12px; font-weight:700;">+ ADD</button>
              </div>

            </div>
          </div>
          
          <!-- FAB -->
          <div class="v2-fab">+</div>
        </div>

      </div>
      
      <script>
        // V2 Logic: Toggle visibility based on props
        (function() {
          const container = document.querySelector('#v2 .mock-screen');
          const observer = new MutationObserver(() => {
            const mode = container.getAttribute('data-mode'); // equal, price_groups, magic_intro
            const role = container.getAttribute('data-role'); // organizer, guest
            
            // Scenario Toggling
            const isMagic = mode === 'magic_intro';
            document.querySelector('#v2 .v2-magic-intro').style.display = isMagic ? 'block' : 'none';
            document.querySelector('#v2 .v2-main-view').style.display = isMagic ? 'none' : 'block';
            
            // Inner Mode Toggling (Equal vs Price Groups)
            container.querySelectorAll('[data-mode-show]').forEach(el => {
              if (el.getAttribute('data-mode-show') === mode) {
                el.style.display = 'block'; // Or flex/grid depending on element, simplified for now
                if (el.classList.contains('v2-item')) el.style.display = 'flex';
              } else {
                el.style.display = 'none';
              }
            });
          });
          observer.observe(container, { attributes: true });
        })();
      </script>
    </div>

    <!-- Version 3: Chat Thread -->
    <div id="v3" class="proposal-container">
      <style>
        #v3 .mock-screen {
          background: #0d1117;
          display: flex;
          flex-direction: column;
        }
        
        #v3 .chat-header {
          padding: 16px;
          border-bottom: 1px solid rgba(255,255,255,0.1);
          background: rgba(22, 27, 34, 0.9);
          backdrop-filter: blur(10px);
          z-index: 10;
        }
        
        #v3 .chat-title {
          font-weight: 700;
          font-size: 16px;
        }
        
        #v3 .chat-subtitle {
          font-size: 12px;
          color: #8b949e;
        }
        
        #v3 .chat-area {
          flex: 1;
          padding: 16px;
          overflow-y: auto;
          display: flex;
          flex-direction: column;
          gap: 16px;
        }
        
        #v3 .msg-bubble {
          max-width: 80%;
          padding: 12px 16px;
          border-radius: 16px;
          position: relative;
          font-size: 14px;
          line-height: 1.4;
        }
        
        #v3 .msg-system {
          align-self: center;
          background: rgba(255,255,255,0.05);
          border-radius: 8px;
          font-size: 12px;
          color: #8b949e;
          padding: 4px 12px;
          margin: 8px 0;
        }
        
        #v3 .msg-bot {
          align-self: flex-start;
          background: #21262d;
          border-top-left-radius: 4px;
          color: #e6edf3;
        }
        
        #v3 .msg-user {
          align-self: flex-end;
          background: #238636;
          border-top-right-radius: 4px;
          color: #fff;
        }
        
        #v3 .bill-card {
          background: #161b22;
          border: 1px solid #30363d;
          border-radius: 12px;
          padding: 16px;
          margin-bottom: 8px;
        }
        
        #v3 .input-area {
          padding: 16px;
          background: #161b22;
          border-top: 1px solid #30363d;
          display: flex;
          gap: 12px;
        }
        
        #v3 .chat-input {
          flex: 1;
          background: #0d1117;
          border: 1px solid #30363d;
          border-radius: 20px;
          padding: 8px 16px;
          color: #fff;
        }
        
        #v3 .send-btn {
          width: 36px;
          height: 36px;
          background: #238636;
          border-radius: 50%;
          border: none;
          color: #fff;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        
        #v3 .v3-btn {
          background: #238636;
          border: none;
          color: #fff;
          padding: 8px 16px;
          border-radius: 6px;
          font-weight: 600;
          font-size: 13px;
          cursor: pointer;
          margin-top: 8px;
          width: 100%;
        }
        
        #v3 .chip-group {
          display: flex;
          flex-wrap: wrap;
          gap: 8px;
          margin-top: 12px;
        }
        
        #v3 .chip {
          background: rgba(255,255,255,0.1);
          padding: 6px 12px;
          border-radius: 12px;
          font-size: 12px;
          cursor: pointer;
        }
        
        #v3 .chip.selected {
          background: #238636;
          color: #fff;
        }
      </style>
      
      <div class="mock-screen">
        <div class="chat-header">
          <div class="chat-title">Dinner at Mario's</div>
          <div class="chat-subtitle">4 participants ¬∑ ‚Ç¨142.50</div>
        </div>
        
        <div class="chat-area">
          <div class="msg-system">Tab created by You</div>
          
          <div class="msg-bot" style="width: 100%; background: transparent; padding: 0;">
            <div class="bill-card">
              <div style="font-weight:700; margin-bottom:8px; display:flex; justify-content:space-between;">
                <span>üßæ Total Bill</span>
                <span>‚Ç¨142.50</span>
              </div>
              <div style="font-size:13px; color:#8b949e; margin-bottom:12px;">
                <div data-mode-show="equal">Split equally: ‚Ç¨35.60 / person</div>
                <div data-mode-show="price_groups">Price Groups Active</div>
              </div>
              
              <!-- Price Groups Detail -->
              <div data-mode-show="price_groups" style="background:rgba(255,255,255,0.05); padding:8px; border-radius:8px; margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; font-size:12px; margin-bottom:4px;">
                  <span>üç∑ Alcohol</span>
                  <span>‚Ç¨25.00</span>
                </div>
                <div style="display:flex; justify-content:space-between; font-size:12px;">
                  <span>üíß No Alc</span>
                  <span>‚Ç¨15.00</span>
                </div>
              </div>
              
              <div style="height:4px; background:#30363d; border-radius:2px; overflow:hidden;">
                <div style="width:65%; background:#238636; height:100%;"></div>
              </div>
              <div style="font-size:11px; color:#8b949e; margin-top:4px;">‚Ç¨92.50 collected</div>
            </div>
          </div>
          
          <div class="msg-user">
            I paid my share!
            <div style="font-size:11px; opacity:0.7; margin-top:4px;">‚Ç¨35.60 ¬∑ 10:42 AM</div>
          </div>
          
          <div class="msg-bot">
            <div style="display:flex; align-items:center; gap:8px; margin-bottom:4px;">
              <div style="width:20px; height:20px; background:#6366f1; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:10px;">JD</div>
              <span style="font-weight:600; font-size:12px;">John Doe</span>
            </div>
            Just sent ‚Ç¨35.60 via Revolut.
          </div>
          
          <!-- Magic Link Intro (Injected as latest message) -->
          <div class="msg-bot" data-scenario="magic_intro" style="background: transparent; padding: 0; width: 100%;">
            <div class="bill-card" style="border-color: #238636; background: rgba(35, 134, 54, 0.1);">
              <h3 style="margin-top:0;">üëã Welcome!</h3>
              <p style="font-size:13px; color:#ccc;">Identify yourself to join.</p>
              <input type="text" class="chat-input" placeholder="Your Name" style="width:100%; box-sizing:border-box; margin-bottom:12px;">
              
              <div data-mode-show="price_groups">
                <p style="font-size:12px; font-weight:600; margin-bottom:4px;">Which group?</p>
                <div class="chip-group">
                  <div class="chip selected">üç∑ Alcohol (‚Ç¨25)</div>
                  <div class="chip">üíß No Alc (‚Ç¨15)</div>
                </div>
              </div>
              
              <button class="v3-btn">Join GroupTab</button>
            </div>
          </div>
          
        </div>
        
        <div class="input-area" data-scenario="main">
          <input type="text" class="chat-input" placeholder="Report payment...">
          <button class="send-btn">‚Ç¨</button>
        </div>
      </div>
      
      <script>
        // V3 Logic
        (function() {
          const container = document.querySelector('#v3 .mock-screen');
          const observer = new MutationObserver(() => {
            const mode = container.getAttribute('data-mode');
            const isMagic = mode === 'magic_intro';
            
            // Hide/Show Input Area based on scenario
            const inputArea = document.querySelector('#v3 .input-area');
            if(inputArea) inputArea.style.display = isMagic ? 'none' : 'flex';
            
            // Toggle Magic Intro Bubble
            const introMsg = document.querySelector('#v3 [data-scenario="magic_intro"]');
            if(introMsg) introMsg.style.display = isMagic ? 'block' : 'none';
            
            // Toggle inner content
            container.querySelectorAll('[data-mode-show]').forEach(el => {
              el.style.display = el.getAttribute('data-mode-show') === mode ? 'block' : 'none';
            });
          });
          observer.observe(container, { attributes: true });
        })();
      </script>
    </div>

    <!-- Version 4: Receipt/Ticket -->
    <div id="v4" class="proposal-container">
      <style>
        #v4 .mock-screen {
          background: #2c2c2c; /* Dark desk background */
          display: flex;
          justify-content: center;
          padding-top: 40px;
          overflow-y: auto;
        }

        #v4 .receipt-paper {
          background: #fff;
          width: 100%;
          max-width: 340px;
          min-height: 600px;
          margin-bottom: 40px;
          padding: 24px;
          font-family: 'Courier New', Courier, monospace;
          color: #000;
          box-shadow: 0 10px 20px rgba(0,0,0,0.3);
          position: relative;
          /* Zigzag bottom edge */
          --mask: conic-gradient(from -45deg at bottom,#0000,#000 1deg 90deg,#0000 91deg) 50% / 20px 100%;
          -webkit-mask: var(--mask);
          mask: var(--mask);
          -webkit-mask-repeat: repeat-x;
          mask-repeat: repeat-x;
          padding-bottom: 40px;
        }

        #v4 .r-header {
          text-align: center;
          margin-bottom: 24px;
        }

        #v4 .r-logo {
          font-weight: 900;
          font-size: 24px;
          letter-spacing: -1px;
          margin-bottom: 8px;
          display: inline-block;
          border: 2px solid #000;
          padding: 4px 8px;
        }

        #v4 .r-meta {
          font-size: 12px;
          text-transform: uppercase;
          color: #555;
          margin-bottom: 24px;
          text-align: center;
        }

        #v4 .r-line {
          border-bottom: 1px dashed #000;
          margin: 16px 0;
        }

        #v4 .r-row {
          display: flex;
          justify-content: space-between;
          margin-bottom: 8px;
          font-size: 14px;
        }

        #v4 .r-total-row {
          display: flex;
          justify-content: space-between;
          font-weight: 700;
          font-size: 18px;
          margin-top: 16px;
        }

        #v4 .r-participants {
          margin-top: 24px;
        }
        
        #v4 .r-item {
          display: flex;
          align-items: center;
          margin-bottom: 12px;
        }
        
        #v4 .r-check {
          width: 16px;
          height: 16px;
          border: 1px solid #000;
          margin-right: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 12px;
          font-weight: 700;
        }

        #v4 .r-btn {
          background: #000;
          color: #fff;
          width: 100%;
          padding: 12px;
          font-family: 'Courier New', Courier, monospace;
          font-weight: 700;
          border: none;
          margin-top: 24px;
          cursor: pointer;
          text-transform: uppercase;
        }
        
        #v4 .r-btn:hover {
          background: #333;
        }

        #v4 .r-barcode {
          height: 40px;
          background: repeating-linear-gradient(
            90deg,
            #000,
            #000 2px,
            #fff 2px,
            #fff 4px
          );
          margin-top: 32px;
          opacity: 0.8;
        }

        #v4 .r-input {
          border: none;
          border-bottom: 2px solid #000;
          font-family: 'Courier New', monospace;
          font-size: 18px;
          width: 100%;
          padding: 8px 0;
          margin-bottom: 16px;
          background: transparent;
        }
        
        #v4 .r-select-box {
            border: 1px dashed #000;
            padding: 12px;
            margin-bottom: 8px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
        }
        #v4 .r-select-box.active {
            background: #000;
            color: #fff;
            border-style: solid;
        }
      </style>
      
      <div class="mock-screen">
        <div class="receipt-paper">
          <div class="r-header">
            <div class="r-logo">PayFriends</div>
            <div style="font-size: 12px;">ORIGINAL RECEIPT</div>
          </div>

          <!-- SCENARIO 1: MAGIC INTRO -->
          <div data-scenario="magic_intro">
            <div style="text-align: center; margin-bottom: 32px;">
               <h2 style="font-size: 20px; margin: 0;">GUEST CHECK</h2>
               <p style="font-size: 12px; color: #555;">PLEASE IDENTIFY YOURSELF</p>
            </div>
            
            <label style="font-size: 10px; font-weight: 700;">NAME:</label>
            <input type="text" class="r-input" placeholder="ENTER NAME HERE">
            
            <div data-mode-show="price_groups" style="margin-top: 24px;">
                <div class="r-line"></div>
                <label style="font-size: 10px; font-weight: 700; display: block; margin-bottom: 12px;">SELECT GROUP:</label>
                
                <div class="r-select-box active">
                    <span>[X] ALCOHOL</span>
                    <span>EUR 25.00</span>
                </div>
                <div class="r-select-box">
                    <span>[ ] NO ALC</span>
                    <span>EUR 15.00</span>
                </div>
            </div>
            
            <button class="r-btn">PRINT TICKET & JOIN</button>
          </div>

          <!-- SCENARIO 2: MAIN VIEW -->
          <div data-scenario="main">
            <div class="r-meta">
              DATE: 01/12/2025<br>
              TIME: 20:42<br>
              TABLE: MARIO'S
            </div>

            <div class="r-line"></div>

            <div class="r-row">
              <span>ITEM COUNT</span>
              <span>4 GUESTS</span>
            </div>
            
            <!-- Mode: Equal -->
            <div data-mode-show="equal">
                <div class="r-row">
                  <span>SPLIT MODE</span>
                  <span>EQUAL</span>
                </div>
                <div class="r-row">
                  <span>PER PERSON</span>
                  <span>EUR 35.60</span>
                </div>
            </div>
            
            <!-- Mode: Price Groups -->
            <div data-mode-show="price_groups">
                <div class="r-row">
                  <span>SPLIT MODE</span>
                  <span>GROUPS</span>
                </div>
                <div class="r-row" style="margin-top: 8px; font-style: italic;">
                  <span>2x ALCOHOL</span>
                  <span>EUR 50.00</span>
                </div>
                <div class="r-row" style="font-style: italic;">
                  <span>1x NO ALC</span>
                  <span>EUR 15.00</span>
                </div>
                <div class="r-row" style="font-style: italic;">
                  <span>1x UNASSIGNED</span>
                  <span>EUR 0.00</span>
                </div>
            </div>

            <div class="r-line"></div>

            <div class="r-total-row">
              <span>TOTAL</span>
              <span>EUR 142.50</span>
            </div>
            <div class="r-row">
              <span>PAID</span>
              <span>EUR 92.50</span>
            </div>
            <div class="r-row" style="font-weight:700;">
              <span>BALANCE</span>
              <span>EUR 50.00</span>
            </div>

            <div class="r-line"></div>
            <div style="text-align: center; font-size: 12px; font-weight: 700;">PAYMENT STATUS</div>
            <div class="r-line"></div>

            <div class="r-participants">
              <div class="r-item">
                <div class="r-check">X</div>
                <div style="flex: 1;">YOU (PAUL)</div>
                <div style="font-weight: 700;">PAID</div>
              </div>
              <div class="r-item">
                <div class="r-check"> </div>
                <div style="flex: 1;">JOHN DOE</div>
                <div style="font-weight: 700;">---</div>
              </div>
               <div class="r-item" data-mode-show="price_groups">
                <div class="r-check">?</div>
                <div style="flex: 1;">GUEST 3</div>
                <div style="font-weight: 700;">---</div>
              </div>
            </div>
            
            <button class="r-btn">ADD PAYMENT</button>
          </div>

          <div class="r-barcode"></div>
          <div style="text-align: center; font-size: 10px; margin-top: 8px;">THANK YOU FOR DINING</div>
        </div>
      </div>
      
      <script>
        // V4 Logic
        (function() {
          const container = document.querySelector('#v4 .mock-screen');
          const observer = new MutationObserver(() => {
            const mode = container.getAttribute('data-mode');
            const isMagic = mode === 'magic_intro';
            
            // Toggle scenarios
            const magicView = container.querySelector('[data-scenario="magic_intro"]');
            const mainView = container.querySelector('[data-scenario="main"]');
            if(magicView) magicView.style.display = isMagic ? 'block' : 'none';
            if(mainView) mainView.style.display = isMagic ? 'none' : 'block';
            
            // Toggle inner content
            container.querySelectorAll('[data-mode-show]').forEach(el => {
              el.style.display = el.getAttribute('data-mode-show') === mode ? 'block' : 'none';
            });
          });
          observer.observe(container, { attributes: true });
        })();
      </script>
    </div>

    <!-- Version 5: Neon Dark -->
    <div id="v5" class="proposal-container">
      <style>
        #v5 .mock-screen {
          background: #050505;
          background-image: 
            radial-gradient(circle at 10% 20%, rgba(99, 102, 241, 0.15) 0%, transparent 40%),
            radial-gradient(circle at 90% 80%, rgba(34, 197, 94, 0.15) 0%, transparent 40%);
          color: #fff;
          font-family: 'Inter', system-ui, sans-serif;
          padding: 24px;
          overflow-y: auto;
        }

        #v5 .neon-header {
          margin-top: 60px;
          margin-bottom: 32px;
        }

        #v5 h1 {
          font-weight: 800;
          font-size: 32px;
          background: linear-gradient(to right, #fff, #aaa);
          background-clip: text;
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          margin: 0;
          letter-spacing: -1px;
        }

        #v5 .neon-card {
          background: rgba(255, 255, 255, 0.03);
          backdrop-filter: blur(20px);
          border: 1px solid rgba(255, 255, 255, 0.1);
          border-radius: 24px;
          padding: 24px;
          margin-bottom: 24px;
          box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }

        #v5 .neon-stat {
          display: flex;
          justify-content: space-between;
          align-items: baseline;
          margin-bottom: 8px;
        }

        #v5 .neon-label {
          color: #888;
          font-size: 13px;
          font-weight: 500;
          text-transform: uppercase;
          letter-spacing: 1px;
        }

        #v5 .neon-value {
          font-size: 24px;
          font-weight: 700;
          text-shadow: 0 0 20px rgba(255,255,255,0.2);
        }

        #v5 .neon-progress {
          height: 6px;
          background: #222;
          border-radius: 3px;
          margin-top: 16px;
          overflow: hidden;
          position: relative;
        }

        #v5 .neon-bar {
          height: 100%;
          background: linear-gradient(90deg, #6366f1, #a855f7);
          box-shadow: 0 0 10px #6366f1;
        }

        #v5 .neon-input {
          background: rgba(0,0,0,0.3);
          border: 1px solid #333;
          border-radius: 12px;
          padding: 16px;
          width: 100%;
          color: #fff;
          font-size: 16px;
          transition: all 0.3s;
          margin-bottom: 16px;
        }

        #v5 .neon-input:focus {
          border-color: #6366f1;
          box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
          outline: none;
        }

        #v5 .neon-btn {
          background: linear-gradient(135deg, #6366f1, #8b5cf6);
          border: none;
          color: #fff;
          padding: 16px;
          width: 100%;
          border-radius: 16px;
          font-weight: 700;
          font-size: 16px;
          cursor: pointer;
          box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
          transition: transform 0.2s;
        }

        #v5 .neon-btn:active {
          transform: scale(0.98);
        }

        #v5 .neon-list-item {
          display: flex;
          align-items: center;
          padding: 16px;
          background: rgba(255,255,255,0.02);
          border: 1px solid rgba(255,255,255,0.05);
          border-radius: 16px;
          margin-bottom: 12px;
        }

        #v5 .neon-avatar {
          width: 40px;
          height: 40px;
          border-radius: 12px;
          background: linear-gradient(135deg, #333, #111);
          display: flex;
          align-items: center;
          justify-content: center;
          margin-right: 16px;
          font-weight: 700;
          font-size: 14px;
        }

        #v5 .neon-badge {
          padding: 4px 8px;
          border-radius: 6px;
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
        }

        #v5 .neon-badge.paid {
          background: rgba(34, 197, 94, 0.2);
          color: #4ade80;
          border: 1px solid rgba(34, 197, 94, 0.3);
          box-shadow: 0 0 10px rgba(34, 197, 94, 0.1);
        }
        
        #v5 .pg-option {
            padding: 16px;
            border-radius: 16px;
            border: 1px solid #333;
            background: rgba(0,0,0,0.2);
            margin-bottom: 8px;
            cursor: pointer;
        }
        #v5 .pg-option.selected {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.1);
        }

      </style>
      
      <div class="mock-screen">
        <div class="status-bar">
          <span>9:41</span>
          <span>PF</span>
          <span>üîã</span>
        </div>

        <!-- SCENARIO 1: MAGIC INTRO -->
        <div data-scenario="magic_intro">
          <div class="neon-header">
            <div class="neon-label" style="margin-bottom:12px; color:#6366f1;">Access Request</div>
            <h1>Identify Yourself</h1>
          </div>
          
          <div class="neon-card">
            <input type="text" class="neon-input" placeholder="Enter your name">
            
            <div data-mode-show="price_groups" style="margin-top: 24px;">
                <div class="neon-label" style="margin-bottom: 12px;">Select Designation</div>
                <div class="pg-option selected">
                    <div style="display:flex; justify-content:space-between; font-weight:600;">
                        <span>üç∑ Alcohol</span>
                        <span>‚Ç¨25.00</span>
                    </div>
                </div>
                <div class="pg-option">
                    <div style="display:flex; justify-content:space-between; font-weight:600; color:#888;">
                        <span>üíß No Alcohol</span>
                        <span>‚Ç¨15.00</span>
                    </div>
                </div>
            </div>
            
            <button class="neon-btn" style="margin-top: 24px;">Initialize Access</button>
          </div>
        </div>

        <!-- SCENARIO 2: MAIN VIEW -->
        <div data-scenario="main">
          <div class="neon-header">
            <div style="display:flex; justify-content:space-between; align-items:center;">
               <h1>Dinner at Mario's</h1>
               <div class="neon-avatar">üßæ</div>
            </div>
          </div>

          <div class="neon-card">
            <div class="neon-stat">
              <span class="neon-label">Total Bill</span>
              <span class="neon-value">‚Ç¨142.50</span>
            </div>
            
            <div data-mode-show="equal">
                <div class="neon-stat" style="margin-top:16px;">
                  <span class="neon-label">Your Share</span>
                  <span class="neon-value" style="font-size:18px;">‚Ç¨35.60</span>
                </div>
            </div>
            
            <div data-mode-show="price_groups">
                <div class="neon-stat" style="margin-top:16px;">
                  <span class="neon-label">Group Split</span>
                  <span class="neon-value" style="font-size:14px; color:#888;">Active</span>
                </div>
                <div style="display:flex; gap:8px; margin-top:8px;">
                    <span class="neon-badge" style="background:#333; color:#fff;">üç∑ ‚Ç¨25</span>
                    <span class="neon-badge" style="background:#222; color:#888;">üíß ‚Ç¨15</span>
                </div>
            </div>

            <div class="neon-progress">
              <div class="neon-bar" style="width: 65%"></div>
            </div>
            <div style="margin-top: 8px; text-align: right; font-size: 12px; color: #888;">
              65% Collected
            </div>
          </div>

          <div class="neon-label" style="margin-bottom: 16px;">Participants</div>

          <div class="neon-list-item">
            <div class="neon-avatar" style="border: 1px solid #6366f1; color: #6366f1;">ME</div>
            <div style="flex: 1;">
              <div style="font-weight: 600;">You</div>
              <div style="font-size: 12px; color: #888;">
                 <span data-mode-show="equal">‚Ç¨35.60</span>
                 <span data-mode-show="price_groups">Alcohol Group</span>
              </div>
            </div>
            <div class="neon-badge paid">PAID</div>
          </div>

          <div class="neon-list-item">
            <div class="neon-avatar">JD</div>
            <div style="flex: 1;">
              <div style="font-weight: 600;">John Doe</div>
              <div style="font-size: 12px; color: #888;">
                 <span data-mode-show="equal">‚Ç¨35.60</span>
                 <span data-mode-show="price_groups">No Alc Group</span>
              </div>
            </div>
            <div class="neon-badge" style="background:rgba(255,255,255,0.1); color:#fff;">PENDING</div>
          </div>
          
          <button class="neon-btn" style="margin-top: 24px;">Report Payment</button>

        </div>
      </div>
      
      <script>
        // V5 Logic
        (function() {
          const container = document.querySelector('#v5 .mock-screen');
          const observer = new MutationObserver(() => {
            const mode = container.getAttribute('data-mode');
            const isMagic = mode === 'magic_intro';
            
            const magicView = container.querySelector('[data-scenario="magic_intro"]');
            const mainView = container.querySelector('[data-scenario="main"]');
            if(magicView) magicView.style.display = isMagic ? 'block' : 'none';
            if(mainView) mainView.style.display = isMagic ? 'none' : 'block';
            
            container.querySelectorAll('[data-mode-show]').forEach(el => {
              el.style.display = el.getAttribute('data-mode-show') === mode ? 'block' : 'none';
            });
          });
          observer.observe(container, { attributes: true });
        })();
      </script>
    </div>

    <!-- Version 6: Story Mode -->
    <div id="v6" class="proposal-container">
      <style>
        #v6 .mock-screen {
          background: linear-gradient(45deg, #ff00cc, #333399);
          color: #fff;
          position: relative;
          overflow: hidden;
          display: flex;
          flex-direction: column;
        }

        #v6 .story-bars {
          display: flex;
          gap: 4px;
          padding: 8px 12px;
          padding-top: 44px; /* Status bar space */
          z-index: 10;
        }

        #v6 .story-bar {
          height: 3px;
          background: rgba(255,255,255,0.3);
          flex: 1;
          border-radius: 2px;
        }

        #v6 .story-bar.active {
          background: #fff;
        }

        #v6 .story-content {
          flex: 1;
          display: flex;
          flex-direction: column;
          justify-content: center;
          padding: 32px;
          text-align: center;
          position: relative;
        }

        #v6 .story-slide {
          display: none; /* Toggled via JS */
          height: 100%;
          flex-direction: column;
          justify-content: center;
        }
        #v6 .story-slide.active {
          display: flex;
        }

        #v6 .story-h1 {
          font-size: 42px;
          font-weight: 900;
          line-height: 1.1;
          margin-bottom: 16px;
          text-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        #v6 .story-big-stat {
          font-size: 64px;
          font-weight: 700;
          margin: 24px 0;
        }

        #v6 .story-tag {
          background: rgba(0,0,0,0.5);
          backdrop-filter: blur(10px);
          padding: 8px 16px;
          border-radius: 30px;
          display: inline-block;
          font-weight: 600;
          margin-bottom: 24px;
        }

        #v6 .story-input {
          background: transparent;
          border: none;
          border-bottom: 3px solid #fff;
          color: #fff;
          font-size: 32px;
          text-align: center;
          width: 100%;
          padding-bottom: 8px;
          margin-bottom: 32px;
        }
        #v6 .story-input::placeholder {
          color: rgba(255,255,255,0.5);
        }
        #v6 .story-input:focus {
          outline: none;
        }

        #v6 .story-btn {
          background: #fff;
          color: #000;
          border: none;
          padding: 20px 32px;
          border-radius: 40px;
          font-size: 18px;
          font-weight: 800;
          cursor: pointer;
          box-shadow: 0 10px 20px rgba(0,0,0,0.2);
          width: 100%;
        }
        
        #v6 .story-list {
            text-align: left;
            margin-top: 24px;
        }
        #v6 .story-item {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
            background: rgba(0,0,0,0.3);
            padding: 12px;
            border-radius: 12px;
        }
        #v6 .story-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #fff;
            color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-weight: 700;
        }

        /* Tap zones */
        #v6 .tap-left, #v6 .tap-right {
          position: absolute;
          top: 100px;
          bottom: 100px;
          width: 30%;
          z-index: 5;
        }
        #v6 .tap-left { left: 0; }
        #v6 .tap-right { right: 0; }

      </style>
      
      <div class="mock-screen">
        
        <div class="story-bars">
          <div class="story-bar active" id="bar-1"></div>
          <div class="story-bar" id="bar-2"></div>
          <div class="story-bar" id="bar-3"></div>
        </div>

        <!-- Tap Zones for Simulation -->
        <div class="tap-left" onclick="prevSlide()"></div>
        <div class="tap-right" onclick="nextSlide()"></div>

        <div class="story-content">
          
          <!-- MAGIC INTRO SLIDE -->
          <div class="story-slide active" data-scenario="magic_intro">
            <div class="story-h1">Who's<br>joining?</div>
            <p>Tap to type your name</p>
            
            <input type="text" class="story-input" placeholder="Your Name">
            
            <div data-mode-show="price_groups" style="margin-bottom:24px;">
                <div class="story-tag">Price Group Mode</div>
                <div style="display:flex; gap:12px; justify-content:center;">
                    <div style="background:#fff; color:#000; padding:12px 20px; border-radius:20px; font-weight:700;">üç∑ Alcohol</div>
                    <div style="border:2px solid #fff; padding:12px 20px; border-radius:20px; font-weight:700;">üíß No Alc</div>
                </div>
            </div>
            
            <button class="story-btn">I'm Ready üöÄ</button>
          </div>

          <!-- MAIN SLIDE 1: COVER -->
          <div class="story-slide active" data-scenario="main" id="slide-1">
            <div class="story-tag">Dinner at Mario's</div>
            <div class="story-h1">Total Bill</div>
            <div class="story-big-stat">‚Ç¨142.50</div>
            <p style="opacity:0.8">Tap right to see breakdown</p>
            
            <div data-mode-show="price_groups" style="margin-top:24px; border-top:1px solid rgba(255,255,255,0.3); padding-top:24px;">
                <div style="font-size:18px; font-weight:700;">Splitting by Group</div>
                <div style="margin-top:8px;">Alcohol ‚Ç¨25 ¬∑ No Alc ‚Ç¨15</div>
            </div>
          </div>

          <!-- MAIN SLIDE 2: PARTICIPANTS -->
          <div class="story-slide" data-scenario="main" id="slide-2">
            <div class="story-h1">The Squad</div>
            <div style="font-size: 24px; font-weight: 700;">2/4 Paid</div>
            
            <div class="story-list">
                <div class="story-item">
                    <div class="story-avatar">ME</div>
                    <div style="flex:1">
                        <div>You</div>
                        <div style="font-size:12px; opacity:0.7">Paid ‚Ç¨35.60</div>
                    </div>
                    <div>‚úÖ</div>
                </div>
                <div class="story-item">
                    <div class="story-avatar">JD</div>
                    <div style="flex:1">
                        <div>John Doe</div>
                        <div style="font-size:12px; opacity:0.7">Pending</div>
                    </div>
                    <div>‚è≥</div>
                </div>
            </div>
          </div>

          <!-- MAIN SLIDE 3: ACTION -->
          <div class="story-slide" data-scenario="main" id="slide-3">
            <div class="story-h1">Your Share</div>
            <div class="story-big-stat">
                <span data-mode-show="equal">‚Ç¨35.60</span>
                <span data-mode-show="price_groups">‚Ç¨25.00</span>
            </div>
            
            <div style="margin-bottom: 40px;">
               <div class="story-tag">Status: Paid ‚úÖ</div>
            </div>
            
            <button class="story-btn">Report Payment</button>
            <div style="margin-top:24px; font-size:12px; opacity:0.6">Tap left to go back</div>
          </div>

        </div>
      </div>
      
      <script>
        // V6 Logic
        let currentSlideIndex = 1;
        
        function showSlide(idx) {
          const container = document.querySelector('#v6 .mock-screen');
          const isMagic = container.getAttribute('data-mode') === 'magic_intro';
          
          if(isMagic) return; // Magic has only 1 slide
          
          currentSlideIndex = idx;
          if(currentSlideIndex > 3) currentSlideIndex = 1;
          if(currentSlideIndex < 1) currentSlideIndex = 3;
          
          // Update Slides
          document.querySelectorAll('#v6 .story-slide[data-scenario="main"]').forEach(el => el.classList.remove('active'));
          const target = document.querySelector(`#v6 #slide-${currentSlideIndex}`);
          if(target) target.classList.add('active');
          
          // Update Bars
          document.querySelectorAll('#v6 .story-bar').forEach((el, i) => {
             if(i + 1 <= currentSlideIndex) el.classList.add('active');
             else el.classList.remove('active');
          });
        }

        function nextSlide() { showSlide(currentSlideIndex + 1); }
        function prevSlide() { showSlide(currentSlideIndex - 1); }

        (function() {
          const container = document.querySelector('#v6 .mock-screen');
          const observer = new MutationObserver(() => {
            const mode = container.getAttribute('data-mode');
            const isMagic = mode === 'magic_intro';
            
            const magicView = container.querySelector('[data-scenario="magic_intro"]');
            const mainSlides = container.querySelectorAll('[data-scenario="main"]');
            
            if(isMagic) {
                if(magicView) magicView.classList.add('active');
                mainSlides.forEach(el => el.classList.remove('active'));
                document.querySelector('.story-bars').style.opacity = '0';
            } else {
                if(magicView) magicView.classList.remove('active');
                document.querySelector('.story-bars').style.opacity = '1';
                showSlide(1); // Reset to slide 1
            }
            
            container.querySelectorAll('[data-mode-show]').forEach(el => {
              el.style.display = el.getAttribute('data-mode-show') === mode ? 'block' : 'none';
            });
          });
          observer.observe(container, { attributes: true });
        })();
      </script>
    </div>

  </div>

  <!-- SVG Assets -->
  <svg class="stamp-svg">
    <defs>
      <!-- PAID Stamp -->
      <g id="stamp-paid">
        <circle cx="50" cy="50" r="45" fill="none" stroke="#22c55e" stroke-width="4" stroke-dasharray="8 4" transform="rotate(-15 50 50)"/>
        <text x="50" y="55" text-anchor="middle" fill="#22c55e" font-family="Arial Black, sans-serif" font-size="24" transform="rotate(-15 50 50)">PAID</text>
      </g>
      <!-- ORGANIZER Badge -->
      <g id="badge-organizer">
        <path d="M10,50 L20,20 L80,20 L90,50 L50,90 Z" fill="#f59e0b" />
        <text x="50" y="50" text-anchor="middle" fill="#000" font-weight="bold" font-size="12">BOSS</text>
      </g>
    </defs>
  </svg>

  <script>
    // State Management
    let currentVersion = 1;
    let currentMode = 'equal'; // equal, price_groups, magic_intro
    let currentRole = 'organizer'; // organizer, guest

    function switchVersion(v) {
      currentVersion = v;
      document.querySelectorAll('.version-btn').forEach((btn, idx) => {
        btn.classList.toggle('active', idx + 1 === v);
      });
      document.querySelectorAll('.proposal-container').forEach((el, idx) => {
        el.classList.toggle('active', idx + 1 === v);
      });
      renderCurrentView();
    }

    function updateView() {
      currentMode = document.getElementById('mode-select').value;
      currentRole = document.getElementById('role-select').value;
      renderCurrentView();
    }

    function renderCurrentView() {
      console.log(`Rendering V${currentVersion} | Mode: ${currentMode} | Role: ${currentRole}`);
      // Logic to update inner HTML of the active container based on state
      // This will be populated as we build each version
      
      const container = document.querySelector(`#v${currentVersion} .mock-screen`);
      if(container) {
         // Clear previous content to be rebuilt (or toggle classes)
         // For now, we will implement static HTML structures for each version 
         // that handle their own internal hiding/showing based on classes we add here
         container.setAttribute('data-mode', currentMode);
         container.setAttribute('data-role', currentRole);
      }
    }

    // Initial Render
    updateView();
  </script>
</body>
</html>

