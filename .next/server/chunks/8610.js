exports.id=8610,exports.ids=[8610],exports.modules={8357:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},621:()=>{},6226:(e,t,r)=>{"use strict";r.d(t,{default:()=>s.a});var a=r(9029),s=r.n(a)},9029:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return o},getImageProps:function(){return l}});let a=r(1174),s=r(3078),n=r(2481),i=a._(r(6820));function l(e){let{props:t}=(0,s.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let o=n.Image},5295:(e,t,r)=>{"use strict";r.d(t,{Footer:()=>n});var a=r(326),s=r(434);function n(){let e=new Date().getFullYear();return a.jsx("footer",{className:"mt-auto py-6 text-center text-pf-muted text-sm border-t border-pf-card-border",children:(0,a.jsxs)("div",{className:"container-pf",children:[(0,a.jsxs)("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2 mb-4",children:[a.jsx(s.default,{href:"/features",className:"hover:text-pf-text transition-colors",children:"Features"}),a.jsx(s.default,{href:"/faq",className:"hover:text-pf-text transition-colors",children:"FAQ"}),a.jsx(s.default,{href:"/legal/terms",className:"hover:text-pf-text transition-colors",children:"Terms"}),a.jsx(s.default,{href:"/legal/privacy",className:"hover:text-pf-text transition-colors",children:"Privacy"}),a.jsx(s.default,{href:"/legal/about",className:"hover:text-pf-text transition-colors",children:"About"})]}),(0,a.jsxs)("p",{className:"text-pf-muted/70",children:["\xa9 ",e," PayFriends. All rights reserved."]})]})})}},561:(e,t,r)=>{"use strict";r.d(t,{Header:()=>u});var a=r(326),s=r(7577),n=r(434),i=r(6226),l=r(5047),o=r(1223);function c({isOpen:e,onClose:t,initialMessages:r=[],initialUnreadCount:n=0,onUnreadCountChange:i}){let[o,c]=(0,s.useState)(r),[d,u]=(0,s.useState)(!1),[m,f]=(0,s.useState)(!1),h=(0,s.useRef)(null),x=(0,l.useRouter)(),p=o.filter(e=>!e.read_at).length,g=async()=>{f(!0);try{(await fetch("/api/activity/mark-all-read",{method:"POST"})).ok&&(c(e=>e.map(e=>({...e,read_at:e.read_at||new Date().toISOString()}))),i?.(0))}catch(e){console.error("Failed to mark all as read:",e)}finally{f(!1)}},b=async e=>{try{(await fetch(`/api/activity/${e}/mark-read`,{method:"POST"})).ok&&(c(t=>t.map(t=>t.id===e?{...t,read_at:t.read_at||new Date().toISOString()}:t)),i?.(Math.max(0,p-1)))}catch(e){console.error("Failed to mark as read:",e)}},v=e=>{e.read_at||b(e.id),e.agreement_id?(x.push("/dashboard"),t()):e.tab_id&&(x.push(`/grouptabs/${e.tab_id}`),t())};return e?(0,a.jsxs)("div",{ref:h,className:"absolute right-0 top-full mt-2 w-[400px] max-w-[calc(100vw-32px)] bg-[#0f1419] rounded-xl border border-white/10 shadow-2xl z-50 animate-fadeIn overflow-hidden",style:{maxHeight:"calc(100vh - 120px)"},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-white/10 bg-pf-card/50",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Activity"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[p>0&&a.jsx("button",{onClick:g,disabled:m,className:"text-xs text-pf-accent hover:underline disabled:opacity-50",children:m?"Marking...":"Mark all read"}),a.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10 text-pf-muted",children:"\xd7"})]})]}),a.jsx("div",{className:"overflow-y-auto",style:{maxHeight:"calc(100vh - 200px)"},children:d?a.jsx("div",{className:"py-8 text-center text-pf-muted",children:"Loading..."}):0===o.length?(0,a.jsxs)("div",{className:"py-8 text-center text-pf-muted",children:[a.jsx("p",{className:"text-4xl mb-2",children:"\uD83D\uDCED"}),a.jsx("p",{children:"No activity yet"})]}):a.jsx("div",{className:"divide-y divide-white/5",children:o.map(e=>a.jsx("button",{onClick:()=>v(e),className:`w-full text-left px-4 py-3 transition-colors hover:bg-white/5 ${e.read_at?"":"bg-pf-accent/5"}`,children:(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("span",{className:"text-xl flex-shrink-0 mt-0.5",children:function(e){switch(e){case"AGREEMENT_SENT":return"\uD83D\uDCE4";case"AGREEMENT_ACCEPTED":return"✅";case"AGREEMENT_DECLINED":return"❌";case"AGREEMENT_CANCELLED":return"\uD83D\uDEAB";case"PAYMENT_RECEIVED":return"\uD83D\uDCB0";case"PAYMENT_REMINDER":return"⏰";case"GROUPTAB_INVITE":return"\uD83D\uDCE8";case"GROUPTAB_JOINED":return"\uD83D\uDC4B";case"GROUPTAB_PAYMENT":return"\uD83D\uDCB3";default:return"\uD83D\uDCCC"}}(e.event_type)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[e.subject&&a.jsx("div",{className:`text-sm font-medium mb-0.5 ${e.read_at?"text-pf-muted":"text-pf-text"}`,children:e.subject}),a.jsx("div",{className:`text-sm ${e.read_at?"text-pf-muted":"text-pf-text"}`,children:function(e){let{event_type:t,body:r}=e;if(!t)return r;switch(t){case"AGREEMENT_SENT":return r||"New loan agreement sent";case"AGREEMENT_ACCEPTED":return r||"Loan agreement was accepted";case"AGREEMENT_DECLINED":return r||"Loan agreement was declined";case"AGREEMENT_CANCELLED":return r||"Loan agreement was cancelled";case"PAYMENT_RECEIVED":return r||"Payment was received";case"PAYMENT_REMINDER":return r||"Payment reminder";case"GROUPTAB_INVITE":return r||"You were invited to a GroupTab";case"GROUPTAB_JOINED":return r||"Someone joined your GroupTab";case"GROUPTAB_PAYMENT":return r||"Payment reported on GroupTab";default:return r}}(e)}),a.jsx("div",{className:"text-xs text-pf-muted/70 mt-1",title:new Date(e.created_at).toLocaleString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),children:function(e){let t=new Date(e),r=new Date,a=Math.floor((r.getTime()-t.getTime())/1e3),s=Math.floor(a/60),n=Math.floor(s/60),i=Math.floor(n/24);return a<60?"Just now":s<60?`${s} minute${1===s?"":"s"} ago`:n<24?`${n} hour${1===n?"":"s"} ago`:1===i?"Yesterday":i<7?`${i} days ago`:t.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:t.getFullYear()!==r.getFullYear()?"numeric":void 0})}(e.created_at)})]}),!e.read_at&&a.jsx("span",{className:"w-2 h-2 rounded-full bg-pf-accent flex-shrink-0 mt-2"})]})},e.id))})}),a.jsx("div",{className:"px-4 py-2 border-t border-white/10 text-xs text-pf-muted text-center",children:"Times shown in your local timezone"})]}):null}let d=["bg-[#6366f1]","bg-[#8b5cf6]","bg-[#ec4899]","bg-[#f59e0b]","bg-[#10b981]","bg-[#3b82f6]","bg-[#14b8a6]"];function u({user:e,unreadCount:t=0}){var r;let[u,f]=(0,s.useState)(!1),[h,x]=(0,s.useState)(!1),[p,g]=(0,s.useState)(t),b=(0,s.useRef)(null),v=(0,s.useRef)(null),y=(0,l.useRouter)(),N=(0,l.usePathname)(),w=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),y.push("/login")}catch(e){console.error("Logout error:",e)}},j=(0,o.Qm)(e?.fullName??null),_=(r=e?.fullName??null)?d[(r.charCodeAt(0)||0)%d.length]:d[0],E=e=>"/dashboard"===e?"/dashboard"===N:N.startsWith(e);return(0,a.jsxs)("header",{className:"flex justify-between items-center mb-6 pb-4 border-b border-[rgba(255,255,255,0.08)] relative z-10",children:[a.jsx("div",{className:"flex items-center gap-3",children:(0,a.jsxs)(n.default,{href:"/dashboard",className:"flex items-center gap-3 no-underline",children:[a.jsx(i.default,{src:"/images/payfriends-logov2.png",alt:"PayFriends logo",width:54,height:54,className:"logo-glow"}),(0,a.jsxs)("div",{className:"flex flex-col gap-0.5",children:[a.jsx("span",{className:"text-2xl font-semibold leading-tight text-pf-text",children:"PayFriends.app"}),a.jsx("span",{className:"text-sm leading-tight text-pf-muted mt-0.5",children:"Pay friends, stay friends"})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"relative",ref:v,children:[(0,a.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),f(!1),x(!h)},className:(0,o.cn)("inline-flex items-center justify-center h-10 px-4 rounded-lg border text-sm font-medium cursor-pointer transition-all whitespace-nowrap",h?"bg-pf-card border-[rgba(255,255,255,0.06)]":"bg-transparent border-[rgba(255,255,255,0.15)] hover:bg-[rgba(255,255,255,0.05)]"),style:{minHeight:"40px"},children:[a.jsx("span",{children:"Activity"}),p>0&&(0,a.jsxs)("span",{className:"ml-1.5 text-pf-accent",children:["(",p,")"]})]}),a.jsx(c,{isOpen:h,onClose:()=>x(!1),initialUnreadCount:p,onUnreadCountChange:e=>{g(e)}})]}),(0,a.jsxs)("div",{className:"relative inline-flex items-center",ref:b,children:[a.jsx("button",{onClick:()=>{x(!1),f(!u)},className:(0,o.cn)("inline-flex items-center justify-center w-[54px] h-[54px] p-0 border-0 rounded-full bg-transparent cursor-pointer transition-all flex-shrink-0","hover:scale-105 hover:shadow-[0_0_0_2px_rgba(255,255,255,0.1)]","focus:outline-none focus:shadow-[0_0_0_2px_rgba(61,220,151,0.5)]",u&&"shadow-[0_0_0_2px_rgba(61,220,151,0.5)]"),"aria-haspopup":"true","aria-expanded":u,title:"User menu",children:e?.profilePicturePath?a.jsx("div",{className:"w-[54px] h-[54px] rounded-full overflow-hidden",children:a.jsx(i.default,{src:`/api/profile/picture/${e.id}`,alt:e.fullName||"User",width:54,height:54,className:"w-full h-full object-cover"})}):a.jsx("div",{className:(0,o.cn)("w-[54px] h-[54px] rounded-full flex items-center justify-center text-white font-semibold text-xl uppercase",_),children:j})}),u&&a.jsx("div",{className:"absolute right-0 top-[calc(100%+8px)] min-w-[240px] bg-[#0f1419] rounded-xl border border-[rgba(255,255,255,0.12)] shadow-[0_10px_40px_rgba(0,0,0,0.5)] py-2 z-50",style:{animation:"dropdownFadeIn 0.15s ease-out"},role:"menu",children:(0,a.jsxs)("div",{className:"px-2.5",children:[(0,a.jsxs)("div",{className:"px-2.5 py-2",children:[a.jsx("div",{className:"font-semibold text-pf-text text-sm leading-tight mb-0.5",children:e?.fullName||"User"}),a.jsx("div",{className:"text-xs text-pf-muted leading-tight",children:e?.email})]}),a.jsx("div",{className:"border-t border-[rgba(255,255,255,0.08)] my-1.5"}),a.jsx(m,{href:"/dashboard",active:E("/dashboard"),children:"Loans"}),a.jsx(m,{href:"/grouptabs",active:E("/grouptabs"),children:"GroupTabs"}),a.jsx(m,{href:"/friends",active:E("/friends"),children:"Friends"}),a.jsx("div",{className:"border-t border-[rgba(255,255,255,0.08)] my-1.5"}),a.jsx(m,{href:"/profile",active:E("/profile"),children:"My Profile"}),a.jsx(m,{href:"/settings",active:E("/settings"),children:"Settings"}),a.jsx(m,{href:"/security",active:E("/security"),children:"Security"}),a.jsx("div",{className:"border-t border-[rgba(255,255,255,0.08)] my-1.5"}),a.jsx(m,{href:"/features",active:E("/features"),children:"Features"}),a.jsx(m,{href:"/faq",active:E("/faq"),children:"FAQ"}),a.jsx(m,{href:"/legal",active:E("/legal"),children:"Legal & About"}),e?.isAdmin&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"border-t border-[rgba(255,255,255,0.08)] my-1.5"}),a.jsx(m,{href:"/admin",active:E("/admin"),children:"Admin Panel"})]}),a.jsx("div",{className:"border-t border-[rgba(255,255,255,0.08)] my-1.5"}),a.jsx("button",{onClick:w,className:"w-full text-left bg-transparent border-none px-2.5 py-2 text-sm text-[#ff6b6b] cursor-pointer rounded-md transition-colors hover:bg-[rgba(255,107,107,0.1)] font-medium",role:"menuitem",children:"Logout"})]})})]})]})]})}function m({href:e,children:t,active:r=!1}){return a.jsx(n.default,{href:e,className:(0,o.cn)("block w-full text-left px-2.5 py-2 text-sm cursor-pointer rounded-md transition-colors font-medium no-underline",r?"bg-[rgba(61,220,151,0.1)] text-pf-accent font-semibold":"text-pf-text hover:bg-[rgba(255,255,255,0.08)]"),role:"menuitem",children:t})}},1223:(e,t,r)=>{"use strict";r.d(t,{Qm:()=>i,cn:()=>n});var a=r(1135),s=r(1009);function n(...e){return(0,s.m6)((0,a.W)(e))}function i(e){return e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?"}},2029:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n,metadata:()=>s});var a=r(9510);r(5023);let s={title:"PayFriends — Loans Between Friends",description:"Create simple loan agreements between friends and family. Track payments, manage repayment schedules, and keep relationships healthy.",icons:{icon:"/favicon.svg",apple:"/apple-touch-icon.png"}};function n({children:e}){return a.jsx("html",{lang:"en",children:a.jsx("body",{className:"bg-pf-bg text-pf-text min-h-screen",children:e})})}},1953:(e,t,r)=>{"use strict";r.d(t,{$:()=>a});let a=(0,r(8570).createProxy)(String.raw`/Users/paulsomers/Dev/payfriends-mvp/src/components/Footer.tsx#Footer`)},3188:(e,t,r)=>{"use strict";r.d(t,{h:()=>a});let a=(0,r(8570).createProxy)(String.raw`/Users/paulsomers/Dev/payfriends-mvp/src/components/Header.tsx#Header`)},5456:(e,t,r)=>{"use strict";r.d(t,{EL:()=>g,Gv:()=>m,TX:()=>b,c_:()=>u,pH:()=>p,ts:()=>d});var a=r(1615),s=r(7096),n=r.n(s),i=r(4770),l=r.n(i),o=r(2027);let c="pf_session";async function d(){try{let e=await (0,a.cookies)(),t=e.get(c)?.value;if(!t)return null;let r=await (0,o.y4)(t);if(!r)return null;if(new Date(r.expires_at)<new Date)return await (0,o.SO)(t),null;let s=await (0,o.GA)(r.user_id);if(!s)return null;return{id:s.id,email:s.email,fullName:s.full_name,publicId:s.public_id,isAdmin:s.is_admin,profilePicturePath:s.profile_picture}}catch(e){return console.error("[Auth] getCurrentUser error:",e),null}}async function u(e){return n().hash(e,10)}async function m(e,t){return n().compare(e,t)}async function f(e){let t=l().randomBytes(32).toString("hex"),r=new Date;return r.setDate(r.getDate()+30),await (0,o.ed)({id:t,userId:e,expiresAt:r.toISOString()}),t}async function h(e){let t=await (0,a.cookies)(),r=new Date;r.setDate(r.getDate()+30),t.set(c,e,{httpOnly:!0,secure:!0,sameSite:"lax",expires:r,path:"/"})}async function x(){(await (0,a.cookies)()).delete(c)}async function p(e,t){try{let r=await (0,o.CX)(e);if(!r||!await m(t,r.password_hash))return{success:!1,error:"Invalid email or password"};let a=await f(r.id);return await h(a),{success:!0,user:{id:r.id,email:r.email,fullName:r.full_name,publicId:r.public_id,isAdmin:r.is_admin,profilePicturePath:r.profile_picture}}}catch(e){return console.error("[Auth] loginUser error:",e),{success:!1,error:"An error occurred during login"}}}async function g(e,t,r){try{if(await (0,o.CX)(e))return{success:!1,error:"An account with this email already exists"};if(t.length<8)return{success:!1,error:"Password must be at least 8 characters"};let a=await u(t),s=l().randomBytes(8).toString("hex"),n=await (0,o.r4)({email:e,passwordHash:a,fullName:r,publicId:s}),i=await f(n.id);return await h(i),{success:!0,user:{id:n.id,email:n.email,fullName:n.full_name,publicId:n.public_id,isAdmin:n.is_admin,profilePicturePath:n.profile_picture}}}catch(e){return console.error("[Auth] signupUser error:",e),{success:!1,error:"An error occurred during signup"}}}async function b(){try{let e=await (0,a.cookies)(),t=e.get(c)?.value;t&&await (0,o.SO)(t),await x()}catch(e){console.error("[Auth] logoutUser error:",e)}}},5023:()=>{}};