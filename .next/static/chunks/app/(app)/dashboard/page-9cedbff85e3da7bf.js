(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[40],{694:function(e,t,n){Promise.resolve().then(n.t.bind(n,5878,23)),Promise.resolve().then(n.t.bind(n,2972,23)),Promise.resolve().then(n.bind(n,3347))},7648:function(e,t,n){"use strict";n.d(t,{default:function(){return l.a}});var r=n(2972),l=n.n(r)},3347:function(e,t,n){"use strict";n.d(t,{LoansPageClient:function(){return m}});var r=n(7437),l=n(2265),a=n(7648),s=n(2967),i=n(3448);let c={pending:{color:"bg-yellow-400",label:"Pending"},active:{color:"bg-green-500",label:"Active"},settled:{color:"bg-gray-400",label:"Settled"},cancelled:{color:"bg-gray-400",label:"Cancelled"},declined:{color:"bg-red-400",label:"Declined"},overdue:{color:"bg-red-400",label:"Overdue"}};function d(e){let{status:t,className:n}=e,l=c[t]||c.pending;return(0,r.jsxs)("div",{className:(0,i.cn)("relative inline-flex items-center justify-center group",n),children:[(0,r.jsx)("span",{className:(0,i.cn)("inline-block w-4 h-4 rounded-full cursor-help",l.color),role:"img","aria-label":l.label}),(0,r.jsxs)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-1.5 bg-gray-800 text-white text-xs rounded-md whitespace-nowrap opacity-0 pointer-events-none group-hover:opacity-100 transition-opacity duration-200 border border-white/10 z-50",children:[l.label,(0,r.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 border-4 border-transparent border-t-gray-800"})]})]})}var o=n(7254);function u(e){let{agreements:t,currentUser:n,filter:l="all",currentAgreementId:c}=e,u=t.filter(e=>"cancelled"!==e.status);"all"!==l&&(u=u.filter(e=>e.status===l));let m=new Set;u.forEach(e=>{m.add(e.lender_user_id===n.id?"lender":"borrower")});let x="Counterparty",p="Due";return(1===m.size&&(m.has("lender")?(x="Borrower",p="Next repayment due"):(x="Lender",p="Next payment due")),0===u.length)?(0,r.jsxs)("div",{className:"text-center py-16 px-8",children:[(0,r.jsx)("div",{className:"text-5xl mb-4 opacity-50",children:"\uD83D\uDCCB"}),(0,r.jsx)("p",{className:"text-base text-pf-muted mb-2",children:"No agreements found"}),(0,r.jsx)("p",{className:"text-sm text-pf-muted/70",children:"Try adjusting the filter above."})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full border-collapse",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"text-pf-muted text-left px-3 py-2.5 text-[13px] font-semibold border-b border-pf-card-border",children:x}),(0,r.jsx)("th",{className:"text-pf-muted text-left px-3 py-2.5 text-[13px] font-semibold border-b border-pf-card-border",children:"Description"}),(0,r.jsx)("th",{className:"text-pf-muted text-left px-3 py-2.5 text-[13px] font-semibold border-b border-pf-card-border",children:"Outstanding / Total"}),(0,r.jsx)("th",{className:"text-pf-muted text-left px-3 py-2.5 text-[13px] font-semibold border-b border-pf-card-border",children:p}),(0,r.jsx)("th",{className:"text-pf-muted text-center px-3 py-2.5 text-[13px] font-semibold border-b border-pf-card-border w-20",children:"Status"}),(0,r.jsx)("th",{className:"text-pf-muted text-right px-3 py-2.5 text-[13px] font-semibold border-b border-pf-card-border",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:u.map(e=>{var t,l,u;let m=e.lender_user_id===n.id,x=m?{name:(null===(t=e.borrower)||void 0===t?void 0:t.full_name)||e.friend_first_name||e.borrower_email,email:e.borrower_email,userId:e.borrower_user_id}:{name:(null===(l=e.lender)||void 0===l?void 0:l.full_name)||e.lender_name,email:(null===(u=e.lender)||void 0===u?void 0:u.email)||"",userId:e.lender_user_id},p=e.amount_cents,f=e.amount_cents,b=e.amount_cents,h=f!==b?"Principal: ".concat((0,o.tV)(b)):"Original: ".concat((0,o.tV)(b)),g=function(e,t){if("settled"===e.status)return{text:"—",className:"text-pf-muted"};let n=e.due_date;if(!n)return{text:"—",className:"text-pf-muted"};let r=new Date(n),l=new Date;l.setHours(0,0,0,0),r.setHours(0,0,0,0);let a=Math.round((r.getTime()-l.getTime())/864e5),s=r.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),i="",c="";if(a<0?(i="text-red-400",c="".concat(Math.abs(a)," day").concat(1!==Math.abs(a)?"s":""," overdue")):0===a?(i="text-yellow-400",c="Due today"):a<=7?(i="text-amber-400",c="".concat(a," day").concat(1!==a?"s":""," left")):(i="text-pf-muted",c="".concat(a," days left")),"active"===e.status&&"installments"===e.repayment_type){let t=e.installment_count||1,n=Math.ceil(e.amount_cents/t),r=(0,o.tV)(n);return{text:"".concat(r," on ").concat(s," (").concat(c,")"),className:i}}return{text:c?"".concat(s," (").concat(c,")"):s,className:i}}(e,0),j=c===e.id;return(0,r.jsxs)("tr",{className:(0,i.cn)("border-b border-pf-card-border hover:bg-white/[0.02]",j&&"bg-pf-accent/5"),children:[(0,r.jsx)("td",{className:"px-3 py-2.5 align-middle",children:(0,r.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,r.jsx)(s.Y,{name:x.name,userId:x.userId,size:"sm"}),(0,r.jsx)("span",{className:"text-pf-text",children:x.name||x.email})]})}),(0,r.jsx)("td",{className:"px-3 py-2.5 align-middle",children:e.description?(0,r.jsx)("span",{className:"text-pf-text",children:e.description}):(0,r.jsx)("span",{className:"text-pf-muted italic",children:"(No description)"})}),(0,r.jsx)("td",{className:"px-3 py-2.5 align-middle",children:(0,r.jsxs)("span",{className:"text-pf-text",title:h,children:[(0,o.tV)(p)," / ",(0,o.tV)(f)]})}),(0,r.jsx)("td",{className:"px-3 py-2.5 align-middle",children:(0,r.jsx)("div",{className:(0,i.cn)("whitespace-nowrap",g.className),children:g.text})}),(0,r.jsx)("td",{className:"px-3 py-2.5 align-middle text-center",children:(0,r.jsx)(d,{status:e.status})}),(0,r.jsx)("td",{className:"px-3 py-2.5 align-middle",children:(0,r.jsx)("div",{className:"flex items-center justify-end gap-2 flex-wrap",children:"cancelled"===e.status?(0,r.jsx)("span",{className:"text-pf-muted",children:"—"}):"pending"!==e.status||m?(0,r.jsx)(a.default,{href:"/agreements/".concat(e.id,"/manage"),className:(0,i.cn)("inline-block px-3 py-2 rounded-lg text-sm font-bold transition-all",j?"bg-pf-accent text-pf-bg":"bg-pf-accent text-pf-bg hover:brightness-105"),children:"Manage"}):(0,r.jsx)(a.default,{href:"/review?id=".concat(e.id),className:"inline-block px-3 py-2 rounded-lg bg-yellow-400 text-pf-bg text-sm font-bold hover:brightness-110 transition-all",children:"Review"})})})]},e.id)})})]})})}function m(e){let{agreements:t,currentUser:n}=e,[s,i]=(0,l.useState)("all"),c=e=>{i(e)};return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex items-center justify-between gap-4 mb-6",children:(0,r.jsx)("h1",{className:"text-[28px] font-semibold m-0",children:"Loans"})}),(0,r.jsxs)("div",{className:"bg-pf-card border border-pf-card-border rounded-2xl p-6",children:[(0,r.jsx)("p",{className:"text-pf-muted text-sm mb-6 leading-relaxed",children:"All your loan agreements in one place."}),(0,r.jsxs)("div",{className:"flex gap-2 mb-4 border-b border-pf-card-border",children:[(0,r.jsx)(x,{label:"All",active:"all"===s,onClick:()=>c("all")}),(0,r.jsx)(x,{label:"Pending",active:"pending"===s,onClick:()=>c("pending")}),(0,r.jsx)(x,{label:"Active",active:"active"===s,onClick:()=>c("active")}),(0,r.jsx)(x,{label:"Settled",active:"settled"===s,onClick:()=>c("settled")})]}),(0,r.jsx)(u,{agreements:t,currentUser:n,filter:s}),(0,r.jsx)("div",{className:"flex justify-end mt-4 pt-4",children:(0,r.jsxs)(a.default,{href:"/calculate",className:"inline-flex items-center gap-2 px-5 py-3 rounded-lg bg-pf-accent text-pf-bg font-bold hover:brightness-105 transition-all",children:[(0,r.jsx)("span",{className:"text-lg font-bold",children:"+"}),(0,r.jsx)("span",{children:"New Loan Agreement"})]})})]})]})}function x(e){let{label:t,active:n,onClick:l}=e;return(0,r.jsx)("button",{onClick:l,className:(0,i.cn)("px-4 py-2.5 cursor-pointer text-sm font-medium border-b-2 -mb-px transition-colors bg-transparent border-0",n?"text-pf-accent border-b-pf-accent":"text-pf-muted border-b-transparent hover:text-pf-text"),children:t})}},2967:function(e,t,n){"use strict";n.d(t,{Y:function(){return s}});var r=n(7437),l=n(3448);let a={sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-14 h-14 text-xl"};function s(e){let{name:t,profilePictureUrl:n,userId:s,size:i="md",className:c}=e,d=(0,l.Qm)(t),o=function(e){if(!e)return"bg-indigo-500";let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);let n=["bg-indigo-500","bg-violet-500","bg-pink-500","bg-amber-500","bg-emerald-500","bg-blue-500","bg-teal-500"];return n[Math.abs(t)%n.length]}(t);return n&&s?(0,r.jsx)("div",{className:(0,l.cn)("rounded-full overflow-hidden flex-shrink-0",a[i],c),children:(0,r.jsx)("img",{src:"/api/profile/picture/".concat(s),alt:t||"User",className:"w-full h-full object-cover"})}):(0,r.jsx)("div",{className:(0,l.cn)("rounded-full flex items-center justify-center text-white font-semibold flex-shrink-0",a[i],o,c),children:d})}},7254:function(e,t,n){"use strict";n.d(t,{Sn:function(){return a},p6:function(){return s},tV:function(){return l}});let r="nl-NL";function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;return new Intl.NumberFormat(t,{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(Math.round((null!=e?e:0)/100))}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;return new Intl.NumberFormat(t,{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2}).format((null!=e?e:0)/100)}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,n="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat(t,{year:"numeric",month:"short",day:"numeric"}).format(n)}},3448:function(e,t,n){"use strict";n.d(t,{Qm:function(){return s},cn:function(){return a}});var r=n(1994),l=n(3335);function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,l.m6)((0,r.W)(t))}function s(e){return e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?"}}},function(e){e.O(0,[972,137,878,971,117,744],function(){return e(e.s=694)}),_N_E=e.O()}]);