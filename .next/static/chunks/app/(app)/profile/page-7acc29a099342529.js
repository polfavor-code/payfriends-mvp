(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{8121:function(e,t,r){Promise.resolve().then(r.bind(r,2347))},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var s=r(2972),a=r.n(s)},2347:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n}});var s=r(7437),a=r(2265),l=r(7648),i=r(3448);function n(){var e,t;let[r,n]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0),[u,d]=(0,a.useState)(""),[m,p]=(0,a.useState)(""),[f,h]=(0,a.useState)(!1),[x,g]=(0,a.useState)({message:"",type:""}),[b,v]=(0,a.useState)({message:"",type:""}),y=(0,a.useRef)(null);async function j(){try{let e=await fetch("/api/profile");if(!e.ok){window.location.href="/login";return}let t=await e.json();n(t.user),d(t.user.fullName||""),p(t.user.phoneNumber||"")}catch(e){console.error("Error loading profile:",e)}finally{c(!1)}}async function N(e){if(e.preventDefault(),g({message:"",type:""}),!u.trim()){g({message:"Full name is required",type:"error"});return}h(!0);try{let e=await fetch("/api/profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:u.trim(),phoneNumber:m.trim()||null})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to update profile")}let t=await e.json();n(t.user),g({message:"✓ Profile updated successfully",type:"success"}),setTimeout(()=>g({message:"",type:""}),3e3)}catch(e){g({message:e instanceof Error?e.message:"Failed to update profile",type:"error"})}finally{h(!1)}}async function w(e){var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){v({message:"Uploading...",type:""});try{let e=new FormData;e.append("picture",r);let t=await fetch("/api/profile/picture",{method:"POST",body:e}),s=await t.json();if(!t.ok||!s.success){v({message:s.error||"Failed to upload picture",type:"error"});return}await j(),v({message:"✓ Profile picture updated",type:"success"}),setTimeout(()=>v({message:"",type:""}),3e3)}catch(e){v({message:"Failed to upload picture",type:"error"})}y.current&&(y.current.value="")}}async function k(){if(confirm("Remove profile picture?")){v({message:"Removing...",type:""});try{let e=await fetch("/api/profile/picture",{method:"DELETE"});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to remove picture")}await j(),v({message:"✓ Profile picture removed",type:"success"}),setTimeout(()=>v({message:"",type:""}),3e3)}catch(e){v({message:e instanceof Error?e.message:"Failed to remove picture",type:"error"})}}}if((0,a.useEffect)(()=>{j()},[]),o)return(0,s.jsx)("div",{className:"flex items-center justify-center py-16",children:(0,s.jsx)("div",{className:"loading-spinner"})});let P=(0,i.Qm)(null!==(e=null==r?void 0:r.fullName)&&void 0!==e?e:null),S=function(e){if(!e)return"bg-indigo-500";let t=0;for(let r=0;r<e.length;r++)t=e.charCodeAt(r)+((t<<5)-t);let r=["bg-indigo-500","bg-violet-500","bg-pink-500","bg-amber-500","bg-emerald-500","bg-blue-500","bg-teal-500"];return r[Math.abs(t)%r.length]}(null!==(t=null==r?void 0:r.fullName)&&void 0!==t?t:null);return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4 mb-6",children:[(0,s.jsx)("h1",{className:"text-[28px] font-semibold m-0",children:"My Profile"}),(0,s.jsx)(l.default,{href:"/dashboard",className:"text-pf-accent text-sm hover:underline",children:"← Back to dashboard"})]}),(0,s.jsxs)("div",{className:"bg-pf-card border border-pf-card-border rounded-2xl p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-6",children:"Profile Information"}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-3 mb-6",children:[(0,s.jsx)("div",{className:"cursor-pointer transition-opacity hover:opacity-85",onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.click()},onContextMenu:e=>{(null==r?void 0:r.profilePicturePath)&&(e.preventDefault(),k())},children:(null==r?void 0:r.profilePicturePath)?(0,s.jsx)("div",{className:"w-[120px] h-[120px] rounded-full overflow-hidden",children:(0,s.jsx)("img",{src:"/api/profile/picture/".concat(r.id),alt:r.fullName||"Profile",className:"w-full h-full object-cover"})}):(0,s.jsx)("div",{className:(0,i.cn)("w-[120px] h-[120px] rounded-full flex items-center justify-center text-white text-4xl font-semibold",S),children:P})}),(0,s.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.click()},className:"text-pf-muted text-sm underline hover:text-pf-text cursor-pointer bg-transparent border-0",children:"Change photo"}),(0,s.jsx)("input",{ref:y,type:"file",accept:"image/jpeg,image/png,image/webp",className:"hidden",onChange:w}),b.message&&(0,s.jsx)("p",{className:(0,i.cn)("text-sm text-center","success"===b.type&&"text-pf-accent","error"===b.type&&"text-red-400"),children:b.message})]}),(0,s.jsxs)("form",{onSubmit:N,children:[(0,s.jsxs)("div",{className:"mb-5",children:[(0,s.jsx)("label",{className:"block text-pf-muted text-sm font-medium mb-2",children:"Full legal name (as on passport)"}),(0,s.jsx)("input",{type:"text",value:u,onChange:e=>d(e.target.value),placeholder:"Jane Smith",className:"input",required:!0})]}),(0,s.jsxs)("div",{className:"mb-5",children:[(0,s.jsx)("label",{className:"block text-pf-muted text-sm font-medium mb-2",children:"Email"}),(0,s.jsx)("input",{type:"email",value:(null==r?void 0:r.email)||"",disabled:!0,className:"input opacity-60 cursor-not-allowed"})]}),(0,s.jsxs)("div",{className:"mb-5",children:[(0,s.jsx)("label",{className:"block text-pf-muted text-sm font-medium mb-2",children:"Phone number"}),(0,s.jsx)("input",{type:"tel",value:m,onChange:e=>p(e.target.value),placeholder:"+31 6 12345678",className:"input"}),(0,s.jsx)("p",{className:"text-pf-muted text-xs mt-1.5",children:"Include country code (e.g., +31 for Netherlands)"})]}),(0,s.jsx)("button",{type:"submit",disabled:f,className:"btn-primary w-full mt-2",children:f?"Saving...":"Save Changes"}),x.message&&(0,s.jsx)("p",{className:(0,i.cn)("text-sm text-center mt-3","success"===x.type&&"text-pf-accent","error"===x.type&&"text-red-400"),children:x.message})]})]})]})}},3448:function(e,t,r){"use strict";r.d(t,{Qm:function(){return i},cn:function(){return l}});var s=r(1994),a=r(3335);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}function i(e){return e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?"}}},function(e){e.O(0,[972,137,971,117,744],function(){return e(e.s=8121)}),_N_E=e.O()}]);