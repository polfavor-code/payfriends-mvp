(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[606],{5898:function(e,t,a){Promise.resolve().then(a.bind(a,9711))},3145:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var n=a(8461),s=a.n(n)},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var n=a(2972),s=a.n(n)},8461:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return l},getImageProps:function(){return o}});let n=a(7043),s=a(5346),r=a(5878),i=n._(a(5084));function o(e){let{props:t}=(0,s.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let l=r.Image},9711:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return l}});var n=a(7437),s=a(2265),r=a(7648),i=a(3145),o=a(7254);function l(){let e;let[t,a]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[l,p]=(0,s.useState)("all"),[x,u]=(0,s.useState)("newest"),[m,f]=(0,s.useState)(null),[h,b]=(0,s.useState)({open:!1,tabId:null,tabName:""});(0,s.useEffect)(()=>{g()},[]);let g=async()=>{try{let t=await fetch("/api/user");if(t.ok){var e;let a=await t.json();f((null===(e=a.user)||void 0===e?void 0:e.id)||null)}let n=await fetch("/api/grouptabs"),s=await n.json();a(s.tabs||[])}catch(e){console.error("Error fetching data:",e)}finally{o(!1)}},_=e=>{if("closed"===e.status)return!0;let t="gift_pot_target"===e.gift_mode||"gift_pot_open"===e.gift_mode||e.is_open_pot,a=e.is_open_pot||"gift_pot_open"===e.gift_mode;if(t){if(a)return!1;let t=e.paid_up_cents||e.total_raised_cents||0,n=e.amount_target||0;return n>0&&t>=n}let n=e.total_amount_cents||0,s=e.paid_up_cents||0;return n>0&&s>=n},w=async()=>{if(h.tabId)try{if(!(await fetch("/api/grouptabs/".concat(h.tabId),{method:"DELETE"})).ok)throw Error("Failed to delete");a(t.filter(e=>e.id!==h.tabId)),b({open:!1,tabId:null,tabName:""})}catch(e){console.error("Error deleting tab:",e),alert("Failed to delete tab")}},j=(e=t,"open"===l?e=t.filter(e=>!_(e)):"closed"===l&&(e=t.filter(e=>_(e))),[...e].sort((e,t)=>{if("newest"===x)return new Date(t.created_at).getTime()-new Date(e.created_at).getTime();if("oldest"===x)return new Date(e.created_at).getTime()-new Date(t.created_at).getTime();if("payment_date"===x){let a=e.last_payment_at?new Date(e.last_payment_at).getTime():0,n=t.last_payment_at?new Date(t.last_payment_at).getTime():0;return 0!==a||0!==n?n-a:new Date(t.created_at).getTime()-new Date(e.created_at).getTime()}return 0}));return(0,n.jsxs)("div",{className:"max-w-[1200px] mx-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)("h1",{className:"text-[28px] font-extrabold tracking-tight bg-gradient-to-br from-white to-[#a7b0bd] bg-clip-text text-transparent",children:"GroupTabs"}),(0,n.jsx)("p",{className:"text-sm text-pf-muted",children:"Split expenses with friends"})]}),(0,n.jsxs)(r.default,{href:"/grouptabs/create",className:"hidden sm:flex items-center gap-1.5 bg-pf-accent/15 text-pf-accent border border-pf-accent/30 px-[18px] py-2.5 rounded-3xl font-semibold text-sm hover:bg-pf-accent/25 hover:border-pf-accent/50 hover:-translate-y-0.5 hover:shadow-[0_4px_16px_rgba(61,220,151,0.2)] transition-all",children:[(0,n.jsx)("span",{children:"+"})," New GroupTab"]})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center mb-5 gap-3 flex-col sm:flex-row sm:items-center",children:[(0,n.jsx)("div",{className:"flex gap-2",children:["all","open","closed"].map(e=>(0,n.jsx)("button",{onClick:()=>p(e),className:"px-4 py-2 rounded-[20px] text-[13px] border transition-all ".concat(l===e?"bg-pf-text text-pf-bg border-pf-text font-semibold":"bg-white/[0.03] border-white/[0.08] text-pf-muted hover:bg-white/[0.06] hover:text-pf-text"),children:"all"===e?"All":"open"===e?"Active":"Settled"},e))}),(0,n.jsxs)("select",{value:x,onChange:e=>u(e.target.value),className:"bg-white/[0.03] border border-white/[0.08] text-pf-muted px-3 py-2 rounded-xl text-xs cursor-pointer focus:outline-none focus:border-pf-accent",children:[(0,n.jsx)("option",{value:"newest",children:"Newest first"}),(0,n.jsx)("option",{value:"payment_date",children:"Last Payment"}),(0,n.jsx)("option",{value:"oldest",children:"Oldest first"})]})]}),i?(0,n.jsxs)("div",{className:"text-center py-[60px] text-pf-muted",children:[(0,n.jsx)("div",{className:"w-8 h-8 border-[3px] border-white/10 border-t-pf-accent rounded-full animate-spin mx-auto mb-4"}),"Loading your tabs..."]}):0===j.length?(0,n.jsx)(c,{filter:l}):(0,n.jsx)("div",{className:"flex flex-col gap-3 pb-[100px]",children:j.map(e=>(0,n.jsx)(d,{tab:e,isCreator:e.creator_user_id===m,onDelete:()=>b({open:!0,tabId:e.id,tabName:e.name})},e.id))}),(0,n.jsx)(r.default,{href:"/grouptabs/create",className:"fixed bottom-6 right-6 w-14 h-14 rounded-full bg-pf-accent text-pf-bg flex items-center justify-center text-[28px] shadow-[0_4px_20px_rgba(61,220,151,0.4)] z-[200] hover:scale-[1.08] transition-transform sm:hidden",children:"+"}),h.open&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-[4px] flex items-center justify-center z-[1000]",onClick:()=>b({open:!1,tabId:null,tabName:""}),children:(0,n.jsxs)("div",{className:"bg-[#1a1d24] border border-white/10 rounded-[20px] p-7 max-w-[380px] w-[90%] text-center",onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("div",{className:"text-5xl mb-4",children:"\uD83D\uDDD1️"}),(0,n.jsx)("h3",{className:"text-xl font-bold mb-3",children:"Delete GroupTab?"}),(0,n.jsxs)("p",{className:"text-sm text-pf-muted leading-relaxed mb-6",children:['This will permanently delete "',(0,n.jsx)("strong",{className:"text-pf-text",children:h.tabName}),'".',(0,n.jsx)("br",{}),"This action cannot be undone."]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)("button",{onClick:()=>b({open:!1,tabId:null,tabName:""}),className:"flex-1 py-3.5 px-5 rounded-xl text-sm font-semibold bg-white/[0.08] text-pf-text hover:bg-white/[0.12] transition-colors",children:"Cancel"}),(0,n.jsx)("button",{onClick:w,className:"flex-1 py-3.5 px-5 rounded-xl text-sm font-semibold bg-[#dc2626] text-white hover:bg-[#b91c1c] transition-colors",children:"Delete"})]})]})})]})}function c(e){let{filter:t}=e,a={all:{icon:"\uD83D\uDCED",title:"No tabs yet",text:"Start a new tab to split dinner, a trip, or any shared expense with friends.",showBtn:!0,btnText:"Create your first tab"},open:{icon:"✨",title:"All caught up!",text:"No active tabs right now. All your expenses are settled.",showBtn:!0,btnText:"Start a new tab"},closed:{icon:"\uD83D\uDCCA",title:"No settled tabs",text:"Tabs will appear here once they're fully paid or closed.",showBtn:!1,btnText:""}}[t];return(0,n.jsxs)("div",{className:"text-center py-20 px-5",children:[(0,n.jsx)("div",{className:"text-6xl mb-4 opacity-40",children:a.icon}),(0,n.jsx)("h2",{className:"text-xl font-semibold mb-2",children:a.title}),(0,n.jsx)("p",{className:"text-pf-muted max-w-[280px] mx-auto mb-6 leading-relaxed",children:a.text}),a.showBtn&&(0,n.jsxs)(r.default,{href:"/grouptabs/create",className:"inline-flex items-center gap-2 bg-pf-accent text-pf-bg px-6 py-3.5 rounded-3xl font-semibold hover:-translate-y-0.5 hover:shadow-[0_8px_24px_rgba(61,220,151,0.3)] transition-all",children:[(0,n.jsx)("span",{children:"+"})," ",a.btnText]})]})}function d(e){let t,a,r,l,c,{tab:d,isCreator:p,onDelete:x}=e,[u,m]=(0,s.useState)(!1),f="gift_pot_target"===d.gift_mode||"gift_pot_open"===d.gift_mode||d.is_open_pot,h=d.is_open_pot||"gift_pot_open"===d.gift_mode;if(f){let e=d.paid_up_cents||d.total_raised_cents||0,t=d.amount_target||0;h?(r=(a="closed"===d.status)?100:0,l=0):(r=(a="closed"===d.status||t>0&&e>=t)?100:t>0?Math.min(100,Math.round(e/t*100)):0,l=Math.max(0,t-e))}else{let e=d.total_amount_cents||0,t=d.paid_up_cents||0;l=e-t,r=(a="closed"===d.status||e>0&&l<=0)?100:e>0?Math.min(100,Math.round(t/e*100)):0}let b=2*Math.PI*26,g=b-r/100*b,_=function(e){let t=Math.floor((Date.now()-e.getTime())/1e3);if(t<60)return"just now";let a=Math.floor(t/60);if(a<60)return"".concat(a,"m ago");let n=Math.floor(a/60);if(n<24)return"".concat(n,"h ago");let s=Math.floor(n/24);return s<7?"".concat(s,"d ago"):s<30?"".concat(Math.floor(s/7),"w ago"):"".concat(e.getDate()," ").concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()])}(new Date(d.last_payment_at||d.updated_at||d.created_at)),w="gift"===d.template?"gift_pot_open"===d.gift_mode||"gift_pot_target"===d.gift_mode||d.is_open_pot?"\uD83D\uDCB0":"\uD83C\uDF81":"restaurant"===d.template?"\uD83C\uDF55":"trip"===d.template?"✈️":"one_bill"===d.tab_type?"\uD83E\uDDFE":"✈️",j=d.about_image_path||d.raising_for_image_path,v=d.invite_code?"/tab/".concat(d.invite_code):"/grouptabs/".concat(d.id);if(a)c=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-[#818cf8] font-semibold",children:"Settled"})," \xb7 ",(0,n.jsxs)("span",{className:"text-pf-muted",children:["Updated ",_]})]});else if(f){let e=d.paid_up_cents||d.total_raised_cents||0,t=d.amount_target||0;c=h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("span",{className:"text-[#f59e0b] font-semibold",children:[(0,o.Sn)(e)," raised"]})," \xb7 ",(0,n.jsxs)("span",{className:"text-pf-muted",children:["Updated ",_]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("span",{className:"text-[#f59e0b] font-semibold",children:[(0,o.Sn)(e)," / ",(0,o.Sn)(t)]})," \xb7 ",(0,n.jsxs)("span",{className:"text-pf-muted",children:["Updated ",_]})]})}else c=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("span",{className:"text-[#f59e0b] font-semibold",children:[(0,o.Sn)(l)," unpaid"]})," \xb7 ",(0,n.jsxs)("span",{className:"text-pf-muted",children:["Updated ",_]})]});return(0,n.jsxs)("div",{className:"flex items-center gap-4 bg-white/[0.03] backdrop-blur-[10px] border border-white/[0.08] rounded-2xl px-5 py-[18px] cursor-pointer transition-all duration-[250ms] shadow-[inset_0_1px_0_rgba(255,255,255,0.1)] hover:bg-white/[0.06] hover:border-white/[0.15] hover:-translate-y-0.5 hover:shadow-[inset_0_1px_0_rgba(255,255,255,0.1),0_8px_32px_rgba(0,0,0,0.3)] ".concat(u?"z-50":""),onClick:()=>window.location.href=v,children:[(0,n.jsx)("div",{className:"w-[60px] h-[60px] flex items-center justify-center text-5xl flex-shrink-0 mr-2",children:j?(0,n.jsx)(i.default,{src:j,alt:"",width:60,height:60,className:"w-full h-full object-cover rounded-xl border border-white/10"}):w}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("div",{className:"mb-0.5",children:(0,n.jsx)("span",{className:"text-base font-semibold text-pf-text whitespace-nowrap overflow-hidden text-ellipsis block",children:(t=d.name||"Untitled Tab",("gift_pot_open"===d.gift_mode||"gift_pot_target"===d.gift_mode||d.is_open_pot)&&t.toLowerCase().startsWith("gift for")&&(t="Raising money for"+t.substring(8)),t)})}),(0,n.jsx)("div",{className:"text-sm",children:c})]}),(0,n.jsxs)("div",{className:"w-16 h-16 relative flex items-center justify-center flex-shrink-0 ".concat(a?"drop-shadow-[0_0_8px_rgba(129,140,248,0.25)]":"drop-shadow-[0_0_8px_rgba(61,220,151,0.25)]"),children:[(0,n.jsxs)("svg",{width:"64",height:"64",children:[(0,n.jsx)("circle",{className:"fill-transparent stroke-white/[0.06]",strokeWidth:"4",r:26,cx:"32",cy:"32"}),(0,n.jsx)("circle",{className:"fill-transparent ".concat(a?"stroke-[#818cf8]":"stroke-pf-accent"),strokeWidth:"4",strokeLinecap:"round",r:26,cx:"32",cy:"32",strokeDasharray:b,strokeDashoffset:g,style:{transform:"rotate(-90deg)",transformOrigin:"50% 50%",transition:"stroke-dashoffset 0.5s ease"}})]}),(0,n.jsxs)("span",{className:"absolute text-sm font-bold ".concat(a?"text-[#818cf8]":"text-pf-text"),children:[r,"%"]})]}),(0,n.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,n.jsx)("button",{className:"p-2 text-pf-muted hover:text-pf-text transition-colors",onClick:e=>{e.stopPropagation(),m(!u)},children:(0,n.jsx)("span",{className:"text-base tracking-[3px] leading-none",children:"•••"})}),u&&(0,n.jsxs)("div",{className:"absolute top-full right-0 mt-2 bg-[rgba(22,25,32,0.98)] backdrop-blur-[20px] border border-white/10 rounded-[14px] p-2 min-w-[160px] shadow-[0_12px_40px_rgba(0,0,0,0.5),inset_0_0_0_1px_rgba(255,255,255,0.05)] z-[200] animate-[menuFadeIn_0.15s_ease-out]",onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 px-3.5 py-3 rounded-[10px] text-sm font-medium text-pf-text cursor-pointer hover:bg-white/[0.08] whitespace-nowrap",children:[(0,n.jsx)("span",{children:"✏️"})," Edit"]}),p&&(0,n.jsxs)("div",{className:"flex items-center gap-3 px-3.5 py-3 rounded-[10px] text-sm font-medium text-[#f87171] cursor-pointer hover:bg-[rgba(248,113,113,0.15)] hover:text-[#fca5a5] whitespace-nowrap",onClick:e=>{e.stopPropagation(),m(!1),x()},children:[(0,n.jsx)("span",{children:"\uD83D\uDDD1️"})," Delete"]})]})]})]})}},7254:function(e,t,a){"use strict";a.d(t,{Sn:function(){return r},p6:function(){return i},tV:function(){return s}});let n="nl-NL";function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return new Intl.NumberFormat(t,{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(Math.round((null!=e?e:0)/100))}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return new Intl.NumberFormat(t,{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2}).format((null!=e?e:0)/100)}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,a="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat(t,{year:"numeric",month:"short",day:"numeric"}).format(a)}}},function(e){e.O(0,[972,878,971,117,744],function(){return e(e.s=5898)}),_N_E=e.O()}]);