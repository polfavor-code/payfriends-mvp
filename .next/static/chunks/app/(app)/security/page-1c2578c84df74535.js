(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41],{8059:function(e,s,t){Promise.resolve().then(t.bind(t,1962))},7648:function(e,s,t){"use strict";t.d(s,{default:function(){return a.a}});var r=t(2972),a=t.n(r)},1962:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return d}});var r=t(7437),a=t(2265),n=t(7648),o=t(3448);function d(){let[e,s]=(0,a.useState)(""),[t,d]=(0,a.useState)(""),[c,i]=(0,a.useState)(""),[l,u]=(0,a.useState)(!1),[m,p]=(0,a.useState)({message:"",type:""}),[x,f]=(0,a.useState)({});function b(){f({}),p({message:"",type:""})}async function w(r){r.preventDefault(),b();let a={},n=!1;if(e||(a.currentPassword="Current password is required",n=!0),t?t.length<8&&(a.newPassword="New password must be at least 8 characters",n=!0):(a.newPassword="New password is required",n=!0),c?t!==c&&(a.confirmPassword="Passwords do not match",n=!0):(a.confirmPassword="Please confirm your new password",n=!0),n){f(a);return}u(!0);try{let r=await fetch("/api/security/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:e,newPassword:t})}),a=await r.json();if(!r.ok){"Current password is incorrect"===a.error?f({currentPassword:a.error}):p({message:a.error||"Failed to change password",type:"error"});return}s(""),d(""),i(""),p({message:"Password updated successfully.",type:"success"}),setTimeout(()=>p({message:"",type:""}),5e3)}catch(e){p({message:"Something went wrong. Please try again.",type:"error"})}finally{u(!1)}}return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4 mb-6",children:[(0,r.jsx)("h1",{className:"text-[28px] font-semibold m-0",children:"Security"}),(0,r.jsx)(n.default,{href:"/dashboard",className:"text-pf-accent text-sm hover:underline",children:"← Back to dashboard"})]}),(0,r.jsxs)("div",{className:"bg-pf-card border border-pf-card-border rounded-2xl p-6 mb-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Change password"}),(0,r.jsx)("p",{className:"text-pf-muted text-sm mb-5 leading-relaxed",children:"Update the password you use to log in."}),m.message&&(0,r.jsx)("div",{className:(0,o.cn)("p-3 rounded-lg mb-4 text-sm","success"===m.type&&"bg-pf-accent/10 text-pf-accent border border-pf-accent/20","error"===m.type&&"bg-red-500/10 text-red-400 border border-red-500/20"),children:m.message}),(0,r.jsxs)("form",{onSubmit:w,children:[(0,r.jsxs)("div",{className:"mb-5",children:[(0,r.jsx)("label",{className:"block text-pf-muted text-sm font-medium mb-2",children:"Current password"}),(0,r.jsx)("input",{type:"password",value:e,onChange:e=>{s(e.target.value),f(e=>({...e,currentPassword:void 0}))},autoComplete:"current-password",className:(0,o.cn)("input",x.currentPassword&&"border-red-500"),required:!0}),x.currentPassword&&(0,r.jsx)("p",{className:"text-red-400 text-xs mt-1",children:x.currentPassword})]}),(0,r.jsxs)("div",{className:"mb-5",children:[(0,r.jsx)("label",{className:"block text-pf-muted text-sm font-medium mb-2",children:"New password"}),(0,r.jsx)("input",{type:"password",value:t,onChange:e=>{d(e.target.value),f(e=>({...e,newPassword:void 0}))},autoComplete:"new-password",className:(0,o.cn)("input",x.newPassword&&"border-red-500"),required:!0}),(0,r.jsx)("p",{className:"text-pf-muted text-xs mt-1",children:"Min 8 characters"}),x.newPassword&&(0,r.jsx)("p",{className:"text-red-400 text-xs mt-1",children:x.newPassword})]}),(0,r.jsxs)("div",{className:"mb-5",children:[(0,r.jsx)("label",{className:"block text-pf-muted text-sm font-medium mb-2",children:"Confirm new password"}),(0,r.jsx)("input",{type:"password",value:c,onChange:e=>{i(e.target.value),f(e=>({...e,confirmPassword:void 0}))},autoComplete:"new-password",className:(0,o.cn)("input",x.confirmPassword&&"border-red-500"),required:!0}),x.confirmPassword&&(0,r.jsx)("p",{className:"text-red-400 text-xs mt-1",children:x.confirmPassword})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 mt-6",children:[(0,r.jsx)("button",{type:"submit",disabled:l,className:"btn-primary px-6",children:l?"Saving…":"Save password"}),(0,r.jsx)("button",{type:"button",onClick:function(){s(""),d(""),i(""),b()},className:"text-pf-muted hover:text-pf-text hover:underline bg-transparent border-0 cursor-pointer",children:"Cancel"})]})]})]}),(0,r.jsxs)("div",{className:"bg-pf-card border border-pf-card-border rounded-2xl p-6 opacity-60 relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/30 rounded-2xl pointer-events-none"}),(0,r.jsxs)("h2",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:["Two step verification",(0,r.jsx)("span",{className:"inline-block px-2.5 py-1 rounded-full text-xs font-semibold bg-yellow-500/15 text-yellow-400",children:"Coming soon"})]}),(0,r.jsx)("p",{className:"text-pf-muted text-sm mb-5 leading-relaxed",children:"Add an extra layer of security to your account using an authenticator app or SMS."}),(0,r.jsx)("button",{type:"button",disabled:!0,className:"btn-primary opacity-50 cursor-not-allowed",children:"Set up two step verification"})]})]})}},3448:function(e,s,t){"use strict";t.d(s,{Qm:function(){return o},cn:function(){return n}});var r=t(1994),a=t(3335);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.m6)((0,r.W)(s))}function o(e){return e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?"}}},function(e){e.O(0,[972,137,971,117,744],function(){return e(e.s=8059)}),_N_E=e.O()}]);