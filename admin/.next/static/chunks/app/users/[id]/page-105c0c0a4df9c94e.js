(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{5033:function(e,t,n){Promise.resolve().then(n.t.bind(n,2972,23)),Promise.resolve().then(n.bind(n,943)),Promise.resolve().then(n.bind(n,7864))},943:function(e,t,n){"use strict";n.d(t,{UserActions:function(){return i}});var s=n(7437),a=n(2265),r=n(9376);function i(e){let{userId:t,hasFinancialHistory:n}=e,i=(0,r.useRouter)(),[l,d]=(0,a.useState)(!1),[c,o]=(0,a.useState)(!1),[m,u]=(0,a.useState)(null),h=async()=>{d(!0),u(null);try{let e=await fetch("/api/users/".concat(t,"/delete"),{method:"POST"});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to delete user")}i.push("/users")}catch(e){u(e.message),o(!1)}finally{d(!1)}};return(0,s.jsxs)("div",{className:"space-y-4",children:[m&&(0,s.jsx)("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-2 rounded text-sm",children:m}),(0,s.jsx)("div",{className:"flex gap-3",children:c?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm text-yellow-400",children:n?"User will be anonymized (has financial history)":"User will be permanently deleted"}),(0,s.jsx)("button",{onClick:h,disabled:l,className:"admin-btn admin-btn-danger",children:l?"Deleting...":"Confirm Delete"}),(0,s.jsx)("button",{onClick:()=>o(!1),disabled:l,className:"admin-btn admin-btn-secondary",children:"Cancel"})]}):(0,s.jsx)("button",{onClick:()=>o(!0),disabled:l,className:"admin-btn admin-btn-danger",children:"Delete User"})}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:n?"This user has financial history. Deleting will anonymize their data but preserve financial records.":"This user has no financial history. Deleting will permanently remove their account."})]})}},7864:function(e,t,n){"use strict";n.d(t,{AdminNotesSection:function(){return l}});var s=n(7437),a=n(2265),r=n(9376),i=n(3448);function l(e){let{entityType:t,entityId:n,existingNotes:l}=e,d=(0,r.useRouter)(),[c,o]=(0,a.useState)(""),[m,u]=(0,a.useState)(!1),[h,x]=(0,a.useState)(null),p=async e=>{if(e.preventDefault(),c.trim()){u(!0),x(null);try{let e=await fetch("/api/notes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entityType:t,entityId:n,note:c.trim()})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to add note")}o(""),d.refresh()}catch(e){x(e.message)}finally{u(!1)}}};return(0,s.jsxs)("div",{className:"admin-card p-4",children:[(0,s.jsx)("h2",{className:"text-sm font-semibold text-gray-400 uppercase mb-3",children:"Internal Admin Notes"}),(0,s.jsxs)("form",{onSubmit:p,className:"mb-4",children:[(0,s.jsx)("textarea",{value:c,onChange:e=>o(e.target.value),placeholder:"Add a note... (append-only)",className:"admin-input mb-2",rows:3}),h&&(0,s.jsx)("div",{className:"text-red-400 text-sm mb-2",children:h}),(0,s.jsx)("button",{type:"submit",disabled:m||!c.trim(),className:"admin-btn admin-btn-primary",children:m?"Adding...":"Add Note"})]}),(0,s.jsx)("div",{className:"space-y-3",children:0===l.length?(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"No notes yet."}):l.map(e=>(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded p-3",children:[(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.note}),(0,s.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[e.admin_id," \xb7 ",(0,i.o0)(e.created_at)]})]},e.id))})]})}},3448:function(e,t,n){"use strict";n.d(t,{cn:function(){return r},o0:function(){return i}});var s=n(1994),a=n(3335);function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,s.W)(t))}function i(e){return e?new Date(e).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"â€”"}}},function(e){e.O(0,[972,265,971,117,744],function(){return e(e.s=5033)}),_N_E=e.O()}]);